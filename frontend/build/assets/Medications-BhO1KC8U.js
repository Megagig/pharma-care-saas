import{bi as T,r as w,j as e,B as s,aa as F,T as t,Q as d,G as o,bj as $,bk as j,a6 as X,a7 as _,a8 as H,f as S,bl as U,b1 as J,bm as I,C as R,b as Z,Y as D,h as p,a$ as b}from"./index-louytu0d.js";import{m as k}from"./medicationManagementService-CyHUiaEu.js";import{R as v,c as L,b as f,X as A,Y as C,T as M,L as P,d as y}from"./LineChart-C8w0z8yz.js";import{B as ee,a as ne}from"./BarChart-B-w3J0QG.js";import{M as te}from"./MedicationSettingsPanel-2dX4-e3P.js";import{A as W}from"./Add-DinP5QbX.js";import"./api-Ce5h1_pV.js";import"./reselect-BYKfjCpY.js";import"./Switch-Cd_KxpXf.js";const c={all:["medicationAnalytics"],adherence:()=>[...c.all,"adherence"],adherenceAnalytics:(n,a)=>[...c.adherence(),n,a],prescriptionPatterns:()=>[...c.all,"prescriptionPatterns"],prescriptionPatternAnalytics:n=>[...c.prescriptionPatterns(),n],interactions:()=>[...c.all,"interactions"],interactionAnalytics:n=>[...c.interactions(),n],costs:()=>[...c.all,"costs"],costAnalytics:n=>[...c.costs(),n],summary:()=>[...c.all,"summary"],patientSummary:n=>[...c.summary(),n]},ie=(n,a="6months")=>T({queryKey:c.adherenceAnalytics(n,a),queryFn:()=>k.getAdherenceAnalytics(n,a),enabled:!!n,staleTime:5*60*1e3,retry:2,retryDelay:h=>Math.min(1e3*2**h,3e4)}),se=n=>T({queryKey:c.prescriptionPatternAnalytics(n),queryFn:()=>k.getPrescriptionPatternAnalytics(n),enabled:!!n,staleTime:10*60*1e3,retry:2,retryDelay:a=>Math.min(1e3*2**a,3e4)}),re=n=>T({queryKey:c.interactionAnalytics(n),queryFn:()=>k.getMedicationInteractionAnalytics(n),enabled:!!n,staleTime:15*60*1e3,retry:2,retryDelay:a=>Math.min(1e3*2**a,3e4)}),ae=n=>T({queryKey:c.costAnalytics(n),queryFn:()=>k.getMedicationCostAnalytics(n),enabled:!!n,staleTime:20*60*1e3,retry:2,retryDelay:a=>Math.min(1e3*2**a,3e4)}),oe=n=>T({queryKey:c.patientSummary(n),queryFn:()=>k.getPatientMedicationSummary(n),enabled:!!n,staleTime:5*60*1e3,retry:1,retryDelay:a=>Math.min(1e3*2**a,15e3)}),ce=({patientId:n})=>{const[a,h]=w.useState("6months"),[l,g]=w.useState(0),q=(u,Q)=>{g(Q)},{data:i,isLoading:G}=ie(n,a),{data:m,isLoading:Y}=se(n),{data:B,isLoading:z}=re(n),{data:x,isLoading:E}=oe(n),{data:r,isLoading:V}=ae(n),N=u=>{h(u.target.value)};if(G||Y||z||E||V)return e.jsx(s,{sx:{display:"flex",justifyContent:"center",p:3},children:e.jsx(F,{})});const O=n==="system"?"System-wide Medication Analytics":"Patient Medication Analytics";return e.jsxs(s,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:O}),e.jsx(d,{sx:{p:3,mb:3},children:e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{sx:{gridColumn:"span 12",md:3},children:e.jsxs(s,{sx:{textAlign:"center"},children:[e.jsx(t,{variant:"h3",color:"primary",children:(x==null?void 0:x.activeCount)||0}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Active Medications"})]})}),e.jsx(o,{sx:{gridColumn:"span 12",md:3},children:e.jsxs(s,{sx:{textAlign:"center"},children:[e.jsxs(t,{variant:"h3",color:"primary",children:[(x==null?void 0:x.adherenceRate)||0,"%"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Adherence Rate"})]})}),e.jsx(o,{sx:{gridColumn:"span 12",md:3},children:e.jsxs(s,{sx:{textAlign:"center"},children:[e.jsx(t,{variant:"h3",color:"error",children:(x==null?void 0:x.interactionCount)||0}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Potential Interactions"})]})}),e.jsx(o,{sx:{gridColumn:"span 12",md:3},children:e.jsxs(s,{sx:{textAlign:"center"},children:[e.jsx(t,{variant:"h3",color:"primary",children:(r==null?void 0:r.formattedTotalCost)||"₦0.00"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Monthly Cost"})]})})]})}),e.jsx(s,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:e.jsxs($,{value:l,onChange:q,children:[e.jsx(j,{label:"Adherence"}),e.jsx(j,{label:"Prescriptions"}),e.jsx(j,{label:"Interactions"}),e.jsx(j,{label:"Financial"})]})}),l===0&&i&&e.jsxs(s,{children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(t,{variant:"h6",children:"Adherence Analytics"}),e.jsxs(X,{sx:{minWidth:150},size:"small",children:[e.jsx(_,{children:"Time Period"}),e.jsxs(H,{value:a,label:"Time Period",onChange:N,children:[e.jsx(S,{value:"3months",children:"Last 3 Months"}),e.jsx(S,{value:"6months",children:"Last 6 Months"}),e.jsx(S,{value:"1year",children:"Last Year"})]})]})]}),e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{sx:{gridColumn:"span 12",md:6},children:e.jsxs(d,{sx:{p:2,height:"100%"},children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,children:"Monthly Adherence Trends"}),e.jsx(v,{width:"100%",height:300,children:e.jsxs(L,{data:(i==null?void 0:i.monthlyAdherence)||[],children:[e.jsx(f,{strokeDasharray:"3 3"}),e.jsx(A,{dataKey:"month"}),e.jsx(C,{domain:[0,100]}),e.jsx(M,{}),e.jsx(P,{}),e.jsx(y,{type:"monotone",dataKey:"adherence",stroke:"#8884d8",activeDot:{r:8},strokeWidth:2,name:"Adherence %"})]})}),e.jsx(s,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mt:2,color:(i==null?void 0:i.trendDirection)==="up"?"success.main":(i==null?void 0:i.trendDirection)==="down"?"error.main":"text.secondary"},children:e.jsx(t,{variant:"subtitle2",sx:{display:"flex",alignItems:"center"},children:(i==null?void 0:i.trendDirection)==="up"?"↑ Improving Trend":(i==null?void 0:i.trendDirection)==="down"?"↓ Declining Trend":"→ Stable Trend"})})]})}),e.jsx(o,{sx:{gridColumn:"span 12",md:6},children:e.jsxs(d,{sx:{p:2,height:"100%"},children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,children:"Overall Adherence Rate"}),e.jsxs(s,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:300},children:[e.jsxs(s,{sx:{position:"relative",display:"inline-flex",mb:2},children:[e.jsx(F,{variant:"determinate",value:(i==null?void 0:i.averageAdherence)||0,size:160,thickness:5,sx:{color:"primary.main"}}),e.jsx(s,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(t,{variant:"h3",component:"div",color:"text.secondary",children:`${(i==null?void 0:i.averageAdherence)||0}%`})})]}),e.jsx(t,{variant:"body1",align:"center",children:((i==null?void 0:i.averageAdherence)||0)>=90?"Excellent Adherence":((i==null?void 0:i.averageAdherence)||0)>=80?"Good Adherence":((i==null?void 0:i.averageAdherence)||0)>=70?"Fair Adherence":"Needs Improvement"})]})]})})]})]}),l===1&&m&&e.jsxs(s,{children:[e.jsx(t,{variant:"h6",sx:{mb:3},children:"Prescription Pattern Analytics"}),e.jsx(o,{container:!0,spacing:3,children:e.jsx(o,{sx:{gridColumn:"span 12",md:6},children:e.jsxs(d,{sx:{p:2},children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,children:"Medications by Category"}),e.jsx(s,{sx:{height:300},children:(m==null?void 0:m.medicationsByCategory)&&e.jsx(v,{width:"100%",height:"100%",children:e.jsxs(L,{data:(m==null?void 0:m.prescriptionFrequency)||[],children:[e.jsx(f,{strokeDasharray:"3 3"}),e.jsx(A,{dataKey:"month"}),e.jsx(C,{}),e.jsx(M,{}),e.jsx(P,{}),e.jsx(y,{type:"monotone",dataKey:"count",stroke:"#82ca9d",name:"Prescriptions"})]})})})]})})})]}),l===2&&B&&e.jsxs(s,{children:[e.jsx(t,{variant:"h6",sx:{mb:3},children:"Medication Interaction Analytics"}),e.jsx(o,{container:!0,spacing:3,children:e.jsx(o,{sx:{gridColumn:"span 12"},children:e.jsxs(d,{sx:{p:2},children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,children:"Interaction Trend Over Time"}),e.jsx(v,{width:"100%",height:300,children:e.jsxs(L,{data:(B==null?void 0:B.interactionTrends)||[],children:[e.jsx(f,{strokeDasharray:"3 3"}),e.jsx(A,{dataKey:"month"}),e.jsx(C,{}),e.jsx(M,{}),e.jsx(P,{}),e.jsx(y,{type:"monotone",dataKey:"count",stroke:"#ff7300",activeDot:{r:8},name:"Interactions"})]})})]})})})]}),l===3&&r&&e.jsxs(s,{children:[e.jsx(t,{variant:"h6",sx:{mb:3},children:"Medication Financial Analytics"}),e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{sx:{gridColumn:"span 12",md:3},children:e.jsxs(d,{sx:{p:2,height:"100%",textAlign:"center"},children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,children:"Total Revenue"}),e.jsx(t,{variant:"h4",color:"primary.main",children:(r==null?void 0:r.formattedTotalRevenue)||"₦0.00"})]})}),e.jsx(o,{sx:{gridColumn:"span 12",md:3},children:e.jsxs(d,{sx:{p:2,height:"100%",textAlign:"center"},children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,children:"Total Cost"}),e.jsx(t,{variant:"h4",color:"error.main",children:(r==null?void 0:r.formattedTotalCost)||"₦0.00"})]})}),e.jsx(o,{sx:{gridColumn:"span 12",md:3},children:e.jsxs(d,{sx:{p:2,height:"100%",textAlign:"center"},children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,children:"Total Profit"}),e.jsx(t,{variant:"h4",color:"success.main",children:(r==null?void 0:r.formattedTotalProfit)||"₦0.00"})]})}),e.jsx(o,{sx:{gridColumn:"span 12",md:3},children:e.jsxs(d,{sx:{p:2,height:"100%",textAlign:"center"},children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,children:"Profit Margin"}),e.jsx(t,{variant:"h4",color:r!=null&&r.profitMargin&&r.profitMargin>0?"success.main":"error.main",children:(r==null?void 0:r.formattedProfitMargin)||"0%"})]})}),e.jsx(o,{sx:{gridColumn:"span 12",md:6},children:e.jsxs(d,{sx:{p:2},children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,children:"Monthly Revenue vs Cost"}),e.jsx(v,{width:"100%",height:300,children:e.jsxs(L,{data:(r==null?void 0:r.monthlyFinancials)||[],children:[e.jsx(f,{strokeDasharray:"3 3"}),e.jsx(A,{dataKey:"month"}),e.jsx(C,{}),e.jsx(M,{formatter:u=>`₦${u}`}),e.jsx(P,{}),e.jsx(y,{type:"monotone",dataKey:"revenue",stroke:"#8884d8",name:"Revenue",strokeWidth:2}),e.jsx(y,{type:"monotone",dataKey:"cost",stroke:"#ff7300",name:"Cost",strokeWidth:2}),e.jsx(y,{type:"monotone",dataKey:"profit",stroke:"#82ca9d",name:"Profit",strokeWidth:2})]})})]})}),e.jsx(o,{sx:{gridColumn:"span 12",md:6},children:e.jsxs(d,{sx:{p:2},children:[e.jsx(t,{variant:"subtitle1",gutterBottom:!0,children:"Top 5 Most Profitable Medications"}),e.jsx(v,{width:"100%",height:300,children:e.jsxs(ee,{data:(r==null?void 0:r.topProfitableMedications)||[],children:[e.jsx(f,{strokeDasharray:"3 3"}),e.jsx(A,{dataKey:"name"}),e.jsx(C,{}),e.jsx(M,{formatter:u=>`₦${u}`}),e.jsx(P,{}),e.jsx(ne,{dataKey:"profit",fill:"#82ca9d",name:"Profit"})]})})]})})]})]})]})},K=n=>{const{children:a,value:h,index:l,...g}=n;return e.jsx("div",{role:"tabpanel",hidden:h!==l,id:`medications-tabpanel-${l}`,"aria-labelledby":`medications-tab-${l}`,...g,children:h===l&&e.jsx(s,{sx:{p:3},children:a})})},pe=()=>{const[n,a]=w.useState(0),{isActive:h,loading:l}=U(),g=(q,i)=>{a(i)};return l?e.jsx(J,{}):h?e.jsxs(s,{sx:{p:3},children:[e.jsx(I,{children:e.jsx("title",{children:"Medication Management | PharmaCare"})}),e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(s,{children:[e.jsx(t,{variant:"h4",component:"h1",sx:{fontWeight:600,mb:1},children:"Medication Management"}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Manage patient medications, interactions, and adherence tracking"})]}),e.jsx(p,{variant:"contained",color:"primary",startIcon:e.jsx(W,{}),component:b,to:"/patients?for=medications",children:"Select Patient"})]}),e.jsxs(R,{sx:{mb:4},children:[e.jsx(s,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs($,{value:n,onChange:g,"aria-label":"medication management tabs",children:[e.jsx(j,{label:"Dashboard",id:"medications-tab-0"}),e.jsx(j,{label:"Analytics",id:"medications-tab-1"}),e.jsx(j,{label:"Settings",id:"medications-tab-2"})]})}),e.jsxs(K,{value:n,index:0,children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Medication Dashboard"}),e.jsx(t,{paragraph:!0,children:"Please select a patient to view their medication dashboard."}),e.jsx(p,{variant:"outlined",component:b,to:"/patients",startIcon:e.jsx(W,{}),sx:{mr:2},children:"Select Patient"}),e.jsx(p,{variant:"contained",component:b,to:"/medications/dashboard",children:"View Medications Dashboard"})]}),e.jsx(K,{value:n,index:1,children:e.jsx(s,{children:e.jsx(ce,{patientId:"system"})})}),e.jsx(K,{value:n,index:2,children:e.jsx(s,{children:e.jsx(te,{patientId:"system"})})})]})]}):e.jsxs(s,{sx:{p:3},children:[e.jsx(I,{children:e.jsx("title",{children:"Medications | PharmaCare"})}),e.jsx(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:e.jsxs(s,{children:[e.jsx(t,{variant:"h4",component:"h1",sx:{fontWeight:600,mb:1},children:"Medications"}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Manage patient medications, interactions, and adherence tracking"})]})}),e.jsx(R,{sx:{textAlign:"center",py:8},children:e.jsxs(Z,{children:[e.jsx(s,{sx:{width:80,height:80,bgcolor:"secondary.light",borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",mx:"auto",mb:3},children:e.jsx(D,{sx:{fontSize:40,color:"secondary.main"}})}),e.jsx(t,{variant:"h5",sx:{fontWeight:600,mb:2},children:"Premium Feature"}),e.jsx(t,{variant:"body1",color:"text.secondary",sx:{mb:4,maxWidth:"600px",mx:"auto"},children:"Advanced medication tracking, drug interaction checking, adherence monitoring, and prescription management features require a premium subscription."}),e.jsxs(s,{sx:{display:"flex",gap:2,justifyContent:"center",flexWrap:"wrap"},children:[e.jsx(p,{variant:"contained",component:b,to:"/subscriptions",children:"Upgrade Now"}),e.jsx(p,{variant:"outlined",component:b,to:"/dashboard",children:"Back to Dashboard"})]})]})})]})};export{pe as default};
