var bt=Object.defineProperty;var Mt=(I,t,n)=>t in I?bt(I,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):I[t]=n;var l=(I,t,n)=>Mt(I,typeof t!="symbol"?t+"":t,n);import{bW as Me,cC as Ce,ab as Ct,b0 as wt,r as K,j as e,B as $,D as $e,b4 as at,aa as He,Q as se,A as St,T as j,h as te,G as D,C as je,b as ve,bj as Xe,bk as ce,aP as Oe,aQ as Le,aR as Ye,a4 as re,a6 as Se,a7 as Te,a8 as Ae,f as Q,ah as Ee,I as Tt,aS as Pe,bf as At,l as et,w as kt,W as tt,q as $t}from"./index-louytu0d.js";import{A as nt}from"./Add-DinP5QbX.js";import{E as Ot}from"./Edit-B2er_J4R.js";import{D as ut}from"./Delete-CTgRaLP1.js";import{H as Lt}from"./History-DjgRWctw.js";import{P as Yt}from"./Person-BO7Sszq-.js";import{u as Pt,a as It,b as Wt,c as zt,d as Ft,e as Ht,M as Bt,f as Nt,g as Et,h as Rt,i as _t}from"./MedicationSettingsPanel-2dX4-e3P.js";import{d as Ut}from"./usePatients--qdYAPd6.js";import{L as Re}from"./LocalizationProvider-Dw4E6yUa.js";import{D as _e}from"./DatePicker-BPHQbsZD.js";import{S as Ue}from"./Switch-Cd_KxpXf.js";import{R as pe,c as it,b as Ie,X as We,Y as ze,T as ge,L as ye,d as ot}from"./LineChart-C8w0z8yz.js";import{B as lt,a as ct,C as Ve}from"./BarChart-B-w3J0QG.js";import{P as qe,a as Ge}from"./PieChart-DNgwFFqr.js";import"./medicationManagementService-CyHUiaEu.js";import"./api-Ce5h1_pV.js";import"./useMobilePicker-GDqmrovO.js";import"./index-DgEE6Mbq.js";import"./reselect-BYKfjCpY.js";var ht={exports:{}};(function(I,t){(function(n,d){I.exports=d()})(Me,function(){var n=1e3,d=6e4,L=36e5,T="millisecond",m="second",i="minute",b="hour",A="day",C="week",O="month",B="quarter",_="year",G="date",X="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,c=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(x){var o=["th","st","nd","rd"],a=x%100;return"["+x+(o[(a-20)%10]||o[a]||o[0])+"]"}},p=function(x,o,a){var u=String(x);return!u||u.length>=o?x:""+Array(o+1-u.length).join(a)+x},k={s:p,z:function(x){var o=-x.utcOffset(),a=Math.abs(o),u=Math.floor(a/60),s=a%60;return(o<=0?"+":"-")+p(u,2,"0")+":"+p(s,2,"0")},m:function x(o,a){if(o.date()<a.date())return-x(a,o);var u=12*(a.year()-o.year())+(a.month()-o.month()),s=o.clone().add(u,O),h=a-s<0,g=o.clone().add(u+(h?-1:1),O);return+(-(u+(a-s)/(h?s-g:g-s))||0)},a:function(x){return x<0?Math.ceil(x)||0:Math.floor(x)},p:function(x){return{M:O,y:_,w:C,d:A,D:G,h:b,m:i,s:m,ms:T,Q:B}[x]||String(x||"").toLowerCase().replace(/s$/,"")},u:function(x){return x===void 0}},F="en",U={};U[F]=v;var ee="$isDayjsObject",J=function(x){return x instanceof V||!(!x||!x[ee])},q=function x(o,a,u){var s;if(!o)return F;if(typeof o=="string"){var h=o.toLowerCase();U[h]&&(s=h),a&&(U[h]=a,s=h);var g=o.split("-");if(!s&&g.length>1)return x(g[0])}else{var M=o.name;U[M]=o,s=M}return!u&&s&&(F=s),s||!u&&F},P=function(x,o){if(J(x))return x.clone();var a=typeof o=="object"?o:{};return a.date=x,a.args=arguments,new V(a)},w=k;w.l=q,w.i=J,w.w=function(x,o){return P(x,{locale:o.$L,utc:o.$u,x:o.$x,$offset:o.$offset})};var V=function(){function x(a){this.$L=q(a.locale,null,!0),this.parse(a),this.$x=this.$x||a.x||{},this[ee]=!0}var o=x.prototype;return o.parse=function(a){this.$d=function(u){var s=u.date,h=u.utc;if(s===null)return new Date(NaN);if(w.u(s))return new Date;if(s instanceof Date)return new Date(s);if(typeof s=="string"&&!/Z$/i.test(s)){var g=s.match(f);if(g){var M=g[2]-1||0,W=(g[7]||"0").substring(0,3);return h?new Date(Date.UTC(g[1],M,g[3]||1,g[4]||0,g[5]||0,g[6]||0,W)):new Date(g[1],M,g[3]||1,g[4]||0,g[5]||0,g[6]||0,W)}}return new Date(s)}(a),this.init()},o.init=function(){var a=this.$d;this.$y=a.getFullYear(),this.$M=a.getMonth(),this.$D=a.getDate(),this.$W=a.getDay(),this.$H=a.getHours(),this.$m=a.getMinutes(),this.$s=a.getSeconds(),this.$ms=a.getMilliseconds()},o.$utils=function(){return w},o.isValid=function(){return this.$d.toString()!==X},o.isSame=function(a,u){var s=P(a);return this.startOf(u)<=s&&s<=this.endOf(u)},o.isAfter=function(a,u){return P(a)<this.startOf(u)},o.isBefore=function(a,u){return this.endOf(u)<P(a)},o.$g=function(a,u,s){return w.u(a)?this[u]:this.set(s,a)},o.unix=function(){return Math.floor(this.valueOf()/1e3)},o.valueOf=function(){return this.$d.getTime()},o.startOf=function(a,u){var s=this,h=!!w.u(u)||u,g=w.p(a),M=function(ne,R){var Z=w.w(s.$u?Date.UTC(s.$y,R,ne):new Date(s.$y,R,ne),s);return h?Z:Z.endOf(A)},W=function(ne,R){return w.w(s.toDate()[ne].apply(s.toDate("s"),(h?[0,0,0,0]:[23,59,59,999]).slice(R)),s)},z=this.$W,E=this.$M,H=this.$D,ae="set"+(this.$u?"UTC":"");switch(g){case _:return h?M(1,0):M(31,11);case O:return h?M(1,E):M(0,E+1);case C:var ie=this.$locale().weekStart||0,de=(z<ie?z+7:z)-ie;return M(h?H-de:H+(6-de),E);case A:case G:return W(ae+"Hours",0);case b:return W(ae+"Minutes",1);case i:return W(ae+"Seconds",2);case m:return W(ae+"Milliseconds",3);default:return this.clone()}},o.endOf=function(a){return this.startOf(a,!1)},o.$set=function(a,u){var s,h=w.p(a),g="set"+(this.$u?"UTC":""),M=(s={},s[A]=g+"Date",s[G]=g+"Date",s[O]=g+"Month",s[_]=g+"FullYear",s[b]=g+"Hours",s[i]=g+"Minutes",s[m]=g+"Seconds",s[T]=g+"Milliseconds",s)[h],W=h===A?this.$D+(u-this.$W):u;if(h===O||h===_){var z=this.clone().set(G,1);z.$d[M](W),z.init(),this.$d=z.set(G,Math.min(this.$D,z.daysInMonth())).$d}else M&&this.$d[M](W);return this.init(),this},o.set=function(a,u){return this.clone().$set(a,u)},o.get=function(a){return this[w.p(a)]()},o.add=function(a,u){var s,h=this;a=Number(a);var g=w.p(u),M=function(E){var H=P(h);return w.w(H.date(H.date()+Math.round(E*a)),h)};if(g===O)return this.set(O,this.$M+a);if(g===_)return this.set(_,this.$y+a);if(g===A)return M(1);if(g===C)return M(7);var W=(s={},s[i]=d,s[b]=L,s[m]=n,s)[g]||1,z=this.$d.getTime()+a*W;return w.w(z,this)},o.subtract=function(a,u){return this.add(-1*a,u)},o.format=function(a){var u=this,s=this.$locale();if(!this.isValid())return s.invalidDate||X;var h=a||"YYYY-MM-DDTHH:mm:ssZ",g=w.z(this),M=this.$H,W=this.$m,z=this.$M,E=s.weekdays,H=s.months,ae=s.meridiem,ie=function(R,Z,oe,le){return R&&(R[Z]||R(u,h))||oe[Z].slice(0,le)},de=function(R){return w.s(M%12||12,R,"0")},ne=ae||function(R,Z,oe){var le=R<12?"AM":"PM";return oe?le.toLowerCase():le};return h.replace(c,function(R,Z){return Z||function(oe){switch(oe){case"YY":return String(u.$y).slice(-2);case"YYYY":return w.s(u.$y,4,"0");case"M":return z+1;case"MM":return w.s(z+1,2,"0");case"MMM":return ie(s.monthsShort,z,H,3);case"MMMM":return ie(H,z);case"D":return u.$D;case"DD":return w.s(u.$D,2,"0");case"d":return String(u.$W);case"dd":return ie(s.weekdaysMin,u.$W,E,2);case"ddd":return ie(s.weekdaysShort,u.$W,E,3);case"dddd":return E[u.$W];case"H":return String(M);case"HH":return w.s(M,2,"0");case"h":return de(1);case"hh":return de(2);case"a":return ne(M,W,!0);case"A":return ne(M,W,!1);case"m":return String(W);case"mm":return w.s(W,2,"0");case"s":return String(u.$s);case"ss":return w.s(u.$s,2,"0");case"SSS":return w.s(u.$ms,3,"0");case"Z":return g}return null}(R)||g.replace(":","")})},o.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},o.diff=function(a,u,s){var h,g=this,M=w.p(u),W=P(a),z=(W.utcOffset()-this.utcOffset())*d,E=this-W,H=function(){return w.m(g,W)};switch(M){case _:h=H()/12;break;case O:h=H();break;case B:h=H()/3;break;case C:h=(E-z)/6048e5;break;case A:h=(E-z)/864e5;break;case b:h=E/L;break;case i:h=E/d;break;case m:h=E/n;break;default:h=E}return s?h:w.a(h)},o.daysInMonth=function(){return this.endOf(O).$D},o.$locale=function(){return U[this.$L]},o.locale=function(a,u){if(!a)return this.$L;var s=this.clone(),h=q(a,u,!0);return h&&(s.$L=h),s},o.clone=function(){return w.w(this.$d,this)},o.toDate=function(){return new Date(this.valueOf())},o.toJSON=function(){return this.isValid()?this.toISOString():null},o.toISOString=function(){return this.$d.toISOString()},o.toString=function(){return this.$d.toUTCString()},x}(),Y=V.prototype;return P.prototype=Y,[["$ms",T],["$s",m],["$m",i],["$H",b],["$W",A],["$M",O],["$y",_],["$D",G]].forEach(function(x){Y[x[1]]=function(o){return this.$g(o,x[0],x[1])}}),P.extend=function(x,o){return x.$i||(x(o,V,P),x.$i=!0),P},P.locale=q,P.isDayjs=J,P.unix=function(x){return P(1e3*x)},P.en=U[F],P.Ls=U,P.p={},P})})(ht);var Vt=ht.exports;const N=Ce(Vt);var mt={exports:{}};(function(I,t){(function(n,d){I.exports=d()})(Me,function(){var n="week",d="year";return function(L,T,m){var i=T.prototype;i.week=function(b){if(b===void 0&&(b=null),b!==null)return this.add(7*(b-this.week()),"day");var A=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var C=m(this).startOf(d).add(1,d).date(A),O=m(this).endOf(n);if(C.isBefore(O))return 1}var B=m(this).startOf(d).date(A).startOf(n).subtract(1,"millisecond"),_=this.diff(B,n,!0);return _<0?m(this).startOf("week").week():Math.ceil(_)},i.weeks=function(b){return b===void 0&&(b=null),this.week(b)}}})})(mt);var qt=mt.exports;const Gt=Ce(qt);var ft={exports:{}};(function(I,t){(function(n,d){I.exports=d()})(Me,function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},d=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,L=/\d/,T=/\d\d/,m=/\d\d?/,i=/\d*[^-_:/,()\s\d]+/,b={},A=function(f){return(f=+f)+(f>68?1900:2e3)},C=function(f){return function(c){this[f]=+c}},O=[/[+-]\d\d:?(\d\d)?|Z/,function(f){(this.zone||(this.zone={})).offset=function(c){if(!c||c==="Z")return 0;var v=c.match(/([+-]|\d\d)/g),p=60*v[1]+(+v[2]||0);return p===0?0:v[0]==="+"?-p:p}(f)}],B=function(f){var c=b[f];return c&&(c.indexOf?c:c.s.concat(c.f))},_=function(f,c){var v,p=b.meridiem;if(p){for(var k=1;k<=24;k+=1)if(f.indexOf(p(k,0,c))>-1){v=k>12;break}}else v=f===(c?"pm":"PM");return v},G={A:[i,function(f){this.afternoon=_(f,!1)}],a:[i,function(f){this.afternoon=_(f,!0)}],Q:[L,function(f){this.month=3*(f-1)+1}],S:[L,function(f){this.milliseconds=100*+f}],SS:[T,function(f){this.milliseconds=10*+f}],SSS:[/\d{3}/,function(f){this.milliseconds=+f}],s:[m,C("seconds")],ss:[m,C("seconds")],m:[m,C("minutes")],mm:[m,C("minutes")],H:[m,C("hours")],h:[m,C("hours")],HH:[m,C("hours")],hh:[m,C("hours")],D:[m,C("day")],DD:[T,C("day")],Do:[i,function(f){var c=b.ordinal,v=f.match(/\d+/);if(this.day=v[0],c)for(var p=1;p<=31;p+=1)c(p).replace(/\[|\]/g,"")===f&&(this.day=p)}],w:[m,C("week")],ww:[T,C("week")],M:[m,C("month")],MM:[T,C("month")],MMM:[i,function(f){var c=B("months"),v=(B("monthsShort")||c.map(function(p){return p.slice(0,3)})).indexOf(f)+1;if(v<1)throw new Error;this.month=v%12||v}],MMMM:[i,function(f){var c=B("months").indexOf(f)+1;if(c<1)throw new Error;this.month=c%12||c}],Y:[/[+-]?\d+/,C("year")],YY:[T,function(f){this.year=A(f)}],YYYY:[/\d{4}/,C("year")],Z:O,ZZ:O};function X(f){var c,v;c=f,v=b&&b.formats;for(var p=(f=c.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(P,w,V){var Y=V&&V.toUpperCase();return w||v[V]||n[V]||v[Y].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(x,o,a){return o||a.slice(1)})})).match(d),k=p.length,F=0;F<k;F+=1){var U=p[F],ee=G[U],J=ee&&ee[0],q=ee&&ee[1];p[F]=q?{regex:J,parser:q}:U.replace(/^\[|\]$/g,"")}return function(P){for(var w={},V=0,Y=0;V<k;V+=1){var x=p[V];if(typeof x=="string")Y+=x.length;else{var o=x.regex,a=x.parser,u=P.slice(Y),s=o.exec(u)[0];a.call(w,s),P=P.replace(s,"")}}return function(h){var g=h.afternoon;if(g!==void 0){var M=h.hours;g?M<12&&(h.hours+=12):M===12&&(h.hours=0),delete h.afternoon}}(w),w}}return function(f,c,v){v.p.customParseFormat=!0,f&&f.parseTwoDigitYear&&(A=f.parseTwoDigitYear);var p=c.prototype,k=p.parse;p.parse=function(F){var U=F.date,ee=F.utc,J=F.args;this.$u=ee;var q=J[1];if(typeof q=="string"){var P=J[2]===!0,w=J[3]===!0,V=P||w,Y=J[2];w&&(Y=J[2]),b=this.$locale(),!P&&Y&&(b=v.Ls[Y]),this.$d=function(u,s,h,g){try{if(["x","X"].indexOf(s)>-1)return new Date((s==="X"?1e3:1)*u);var M=X(s)(u),W=M.year,z=M.month,E=M.day,H=M.hours,ae=M.minutes,ie=M.seconds,de=M.milliseconds,ne=M.zone,R=M.week,Z=new Date,oe=E||(W||z?1:Z.getDate()),le=W||Z.getFullYear(),ue=0;W&&!z||(ue=z>0?z-1:Z.getMonth());var De,we=H||0,me=ae||0,fe=ie||0,xe=de||0;return ne?new Date(Date.UTC(le,ue,oe,we,me,fe,xe+60*ne.offset*1e3)):h?new Date(Date.UTC(le,ue,oe,we,me,fe,xe)):(De=new Date(le,ue,oe,we,me,fe,xe),R&&(De=g(De).week(R).toDate()),De)}catch{return new Date("")}}(U,q,ee,v),this.init(),Y&&Y!==!0&&(this.$L=this.locale(Y).$L),V&&U!=this.format(q)&&(this.$d=new Date("")),b={}}else if(q instanceof Array)for(var x=q.length,o=1;o<=x;o+=1){J[1]=q[o-1];var a=v.apply(this,J);if(a.isValid()){this.$d=a.$d,this.$L=a.$L,this.init();break}o===x&&(this.$d=new Date(""))}else k.call(this,F)}}})})(ft);var Zt=ft.exports;const Kt=Ce(Zt);var xt={exports:{}};(function(I,t){(function(n,d){I.exports=d()})(Me,function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(d,L,T){var m=L.prototype,i=m.format;T.en.formats=n,m.format=function(b){b===void 0&&(b="YYYY-MM-DDTHH:mm:ssZ");var A=this.$locale().formats,C=function(O,B){return O.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(_,G,X){var f=X&&X.toUpperCase();return G||B[X]||n[X]||B[f].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(c,v,p){return v||p.slice(1)})})}(b,A===void 0?{}:A);return i.call(this,C)}}})})(xt);var Jt=xt.exports;const Qt=Ce(Jt);var pt={exports:{}};(function(I,t){(function(n,d){I.exports=d()})(Me,function(){return function(n,d,L){d.prototype.isBetween=function(T,m,i,b){var A=L(T),C=L(m),O=(b=b||"()")[0]==="(",B=b[1]===")";return(O?this.isAfter(A,i):!this.isBefore(A,i))&&(B?this.isBefore(C,i):!this.isAfter(C,i))||(O?this.isBefore(A,i):!this.isAfter(A,i))&&(B?this.isAfter(C,i):!this.isBefore(C,i))}}})})(pt);var Xt=pt.exports;const en=Ce(Xt);var gt={exports:{}};(function(I,t){(function(n,d){I.exports=d()})(Me,function(){return function(n,d){var L=d.prototype,T=L.format;L.format=function(m){var i=this,b=this.$locale();if(!this.isValid())return T.bind(this)(m);var A=this.$utils(),C=(m||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(O){switch(O){case"Q":return Math.ceil((i.$M+1)/3);case"Do":return b.ordinal(i.$D);case"gggg":return i.weekYear();case"GGGG":return i.isoWeekYear();case"wo":return b.ordinal(i.week(),"W");case"w":case"ww":return A.s(i.week(),O==="w"?1:2,"0");case"W":case"WW":return A.s(i.isoWeek(),O==="W"?1:2,"0");case"k":case"kk":return A.s(String(i.$H===0?24:i.$H),O==="k"?1:2,"0");case"X":return Math.floor(i.$d.getTime()/1e3);case"x":return i.$d.getTime();case"z":return"["+i.offsetName()+"]";case"zzz":return"["+i.offsetName("long")+"]";default:return O}});return T.bind(this)(C)}}})})(gt);var tn=gt.exports;const nn=Ce(tn);N.extend(Qt);N.extend(Gt);N.extend(en);N.extend(nn);const rn={YY:"year",YYYY:{sectionType:"year",contentType:"digit",maxLength:4},M:{sectionType:"month",contentType:"digit",maxLength:2},MM:"month",MMM:{sectionType:"month",contentType:"letter"},MMMM:{sectionType:"month",contentType:"letter"},D:{sectionType:"day",contentType:"digit",maxLength:2},DD:"day",Do:{sectionType:"day",contentType:"digit-with-letter"},d:{sectionType:"weekDay",contentType:"digit",maxLength:2},dd:{sectionType:"weekDay",contentType:"letter"},ddd:{sectionType:"weekDay",contentType:"letter"},dddd:{sectionType:"weekDay",contentType:"letter"},A:"meridiem",a:"meridiem",H:{sectionType:"hours",contentType:"digit",maxLength:2},HH:"hours",h:{sectionType:"hours",contentType:"digit",maxLength:2},hh:"hours",m:{sectionType:"minutes",contentType:"digit",maxLength:2},mm:"minutes",s:{sectionType:"seconds",contentType:"digit",maxLength:2},ss:"seconds"},sn={year:"YYYY",month:"MMMM",monthShort:"MMM",dayOfMonth:"D",dayOfMonthFull:"Do",weekday:"dddd",weekdayShort:"dd",hours24h:"HH",hours12h:"hh",meridiem:"A",minutes:"mm",seconds:"ss",fullDate:"ll",keyboardDate:"L",shortDate:"MMM D",normalDate:"D MMMM",normalDateWithWeekday:"ddd, MMM D",fullTime12h:"hh:mm A",fullTime24h:"HH:mm",keyboardDateTime12h:"L hh:mm A",keyboardDateTime24h:"L HH:mm"},Ze=["Missing UTC plugin","To be able to use UTC or timezones, you have to enable the `utc` plugin","Find more information on https://mui.com/x/react-date-pickers/timezone/#day-js-and-utc"].join(`
`),dt=["Missing timezone plugin","To be able to use timezones, you have to enable both the `utc` and the `timezone` plugin","Find more information on https://mui.com/x/react-date-pickers/timezone/#day-js-and-timezone"].join(`
`);class Ke{constructor({locale:t,formats:n}={}){l(this,"isMUIAdapter",!0);l(this,"isTimezoneCompatible",!0);l(this,"lib","dayjs");l(this,"escapedCharacters",{start:"[",end:"]"});l(this,"formatTokenMap",rn);l(this,"setLocaleToValue",t=>{const n=this.getCurrentLocaleCode();return n===t.locale()?t:t.locale(n)});l(this,"hasUTCPlugin",()=>typeof N.utc<"u");l(this,"hasTimezonePlugin",()=>typeof N.tz<"u");l(this,"isSame",(t,n,d)=>{const L=this.setTimezone(n,this.getTimezone(t));return t.format(d)===L.format(d)});l(this,"cleanTimezone",t=>{switch(t){case"default":return;case"system":return N.tz.guess();default:return t}});l(this,"createSystemDate",t=>{let n;if(this.hasUTCPlugin()&&this.hasTimezonePlugin()){const d=N.tz.guess();d==="UTC"?n=N(t):n=N.tz(t,d)}else n=N(t);return this.setLocaleToValue(n)});l(this,"createUTCDate",t=>{if(!this.hasUTCPlugin())throw new Error(Ze);return this.setLocaleToValue(N.utc(t))});l(this,"createTZDate",(t,n)=>{if(!this.hasUTCPlugin())throw new Error(Ze);if(!this.hasTimezonePlugin())throw new Error(dt);const d=t!==void 0&&!t.endsWith("Z");return this.setLocaleToValue(N(t).tz(this.cleanTimezone(n),d))});l(this,"getLocaleFormats",()=>{const t=N.Ls,n=this.locale||"en";let d=t[n];return d===void 0&&(d=t.en),d.formats});l(this,"adjustOffset",t=>{if(!this.hasTimezonePlugin())return t;const n=this.getTimezone(t);if(n!=="UTC"){const d=t.tz(this.cleanTimezone(n),!0);if(d.$offset===(t.$offset??0))return t;t.$offset=d.$offset}return t});l(this,"date",(t,n="default")=>t===null?null:n==="UTC"?this.createUTCDate(t):n==="system"||n==="default"&&!this.hasTimezonePlugin()?this.createSystemDate(t):this.createTZDate(t,n));l(this,"getInvalidDate",()=>N(new Date("Invalid date")));l(this,"getTimezone",t=>{var n;if(this.hasTimezonePlugin()){const d=(n=t.$x)==null?void 0:n.$timezone;if(d)return d}return this.hasUTCPlugin()&&t.isUTC()?"UTC":"system"});l(this,"setTimezone",(t,n)=>{if(this.getTimezone(t)===n)return t;if(n==="UTC"){if(!this.hasUTCPlugin())throw new Error(Ze);return t.utc()}if(n==="system")return t.local();if(!this.hasTimezonePlugin()){if(n==="default")return t;throw new Error(dt)}return this.setLocaleToValue(N.tz(t,this.cleanTimezone(n)))});l(this,"toJsDate",t=>t.toDate());l(this,"parse",(t,n)=>t===""?null:N(t,n,this.locale,!0));l(this,"getCurrentLocaleCode",()=>this.locale||"en");l(this,"is12HourCycleInCurrentLocale",()=>/A|a/.test(this.getLocaleFormats().LT||""));l(this,"expandFormat",t=>{const n=this.getLocaleFormats(),d=L=>L.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(T,m,i)=>m||i.slice(1));return t.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(L,T,m)=>{const i=m&&m.toUpperCase();return T||n[m]||d(n[i])})});l(this,"isValid",t=>t==null?!1:t.isValid());l(this,"format",(t,n)=>this.formatByString(t,this.formats[n]));l(this,"formatByString",(t,n)=>this.setLocaleToValue(t).format(n));l(this,"formatNumber",t=>t);l(this,"isEqual",(t,n)=>t===null&&n===null?!0:t===null||n===null?!1:t.toDate().getTime()===n.toDate().getTime());l(this,"isSameYear",(t,n)=>this.isSame(t,n,"YYYY"));l(this,"isSameMonth",(t,n)=>this.isSame(t,n,"YYYY-MM"));l(this,"isSameDay",(t,n)=>this.isSame(t,n,"YYYY-MM-DD"));l(this,"isSameHour",(t,n)=>t.isSame(n,"hour"));l(this,"isAfter",(t,n)=>t>n);l(this,"isAfterYear",(t,n)=>this.hasUTCPlugin()?!this.isSameYear(t,n)&&t.utc()>n.utc():t.isAfter(n,"year"));l(this,"isAfterDay",(t,n)=>this.hasUTCPlugin()?!this.isSameDay(t,n)&&t.utc()>n.utc():t.isAfter(n,"day"));l(this,"isBefore",(t,n)=>t<n);l(this,"isBeforeYear",(t,n)=>this.hasUTCPlugin()?!this.isSameYear(t,n)&&t.utc()<n.utc():t.isBefore(n,"year"));l(this,"isBeforeDay",(t,n)=>this.hasUTCPlugin()?!this.isSameDay(t,n)&&t.utc()<n.utc():t.isBefore(n,"day"));l(this,"isWithinRange",(t,[n,d])=>t>=n&&t<=d);l(this,"startOfYear",t=>this.adjustOffset(t.startOf("year")));l(this,"startOfMonth",t=>this.adjustOffset(t.startOf("month")));l(this,"startOfWeek",t=>this.adjustOffset(this.setLocaleToValue(t).startOf("week")));l(this,"startOfDay",t=>this.adjustOffset(t.startOf("day")));l(this,"endOfYear",t=>this.adjustOffset(t.endOf("year")));l(this,"endOfMonth",t=>this.adjustOffset(t.endOf("month")));l(this,"endOfWeek",t=>this.adjustOffset(this.setLocaleToValue(t).endOf("week")));l(this,"endOfDay",t=>this.adjustOffset(t.endOf("day")));l(this,"addYears",(t,n)=>this.adjustOffset(t.add(n,"year")));l(this,"addMonths",(t,n)=>this.adjustOffset(t.add(n,"month")));l(this,"addWeeks",(t,n)=>this.adjustOffset(t.add(n,"week")));l(this,"addDays",(t,n)=>this.adjustOffset(t.add(n,"day")));l(this,"addHours",(t,n)=>this.adjustOffset(t.add(n,"hour")));l(this,"addMinutes",(t,n)=>this.adjustOffset(t.add(n,"minute")));l(this,"addSeconds",(t,n)=>this.adjustOffset(t.add(n,"second")));l(this,"getYear",t=>t.year());l(this,"getMonth",t=>t.month());l(this,"getDate",t=>t.date());l(this,"getHours",t=>t.hour());l(this,"getMinutes",t=>t.minute());l(this,"getSeconds",t=>t.second());l(this,"getMilliseconds",t=>t.millisecond());l(this,"setYear",(t,n)=>this.adjustOffset(t.set("year",n)));l(this,"setMonth",(t,n)=>this.adjustOffset(t.set("month",n)));l(this,"setDate",(t,n)=>this.adjustOffset(t.set("date",n)));l(this,"setHours",(t,n)=>this.adjustOffset(t.set("hour",n)));l(this,"setMinutes",(t,n)=>this.adjustOffset(t.set("minute",n)));l(this,"setSeconds",(t,n)=>this.adjustOffset(t.set("second",n)));l(this,"setMilliseconds",(t,n)=>this.adjustOffset(t.set("millisecond",n)));l(this,"getDaysInMonth",t=>t.daysInMonth());l(this,"getWeekArray",t=>{const n=this.startOfWeek(this.startOfMonth(t)),d=this.endOfWeek(this.endOfMonth(t));let L=0,T=n;const m=[];for(;T<d;){const i=Math.floor(L/7);m[i]=m[i]||[],m[i].push(T),T=this.addDays(T,1),L+=1}return m});l(this,"getWeekNumber",t=>t.week());l(this,"getYearRange",([t,n])=>{const d=this.startOfYear(t),L=this.endOfYear(n),T=[];let m=d;for(;this.isBefore(m,L);)T.push(m),m=this.addYears(m,1);return T});this.locale=t,this.formats=Ct({},sn,n),N.extend(Kt)}getDayOfWeek(t){return t.day()+1}}const Je={name:"",dosage:"",frequency:"",route:"oral",startDate:new Date,endDate:null,indication:"",prescriber:"",cost:"",sellingPrice:"",allergyCheck:{status:!1,details:""},status:"active"},an=[{value:"oral",label:"Oral"},{value:"topical",label:"Topical"},{value:"inhalation",label:"Inhalation"},{value:"injection",label:"Injection"},{value:"sublingual",label:"Sublingual"},{value:"rectal",label:"Rectal"},{value:"vaginal",label:"Vaginal"},{value:"ophthalmic",label:"Ophthalmic"},{value:"otic",label:"Otic"},{value:"nasal",label:"Nasal"},{value:"transdermal",label:"Transdermal"},{value:"other",label:"Other"}],on=[{value:"once daily",label:"Once Daily"},{value:"twice daily",label:"Twice Daily"},{value:"three times daily",label:"Three Times Daily"},{value:"four times daily",label:"Four Times Daily"},{value:"every morning",label:"Every Morning"},{value:"every night",label:"Every Night"},{value:"as needed",label:"As Needed (PRN)"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"},{value:"other",label:"Other"}],$n=({patientId:I})=>{var st;const{patientId:t}=wt(),n=I||t,[d,L]=K.useState(0),[T,m]=K.useState(!1),[i,b]=K.useState(0),[A,C]=K.useState([]),[O,B]=K.useState(!1),[_,G]=K.useState(!1),[X,f]=K.useState(!1),[c,v]=K.useState(Je),[p,k]=K.useState({medicationId:"",refillDate:new Date,adherenceScore:100,pillCount:0,notes:""}),[F,U]=K.useState(null),[ee,J]=K.useState([]),[q,P]=K.useState(!0),[w,V]=K.useState([]),{data:Y,isLoading:x,error:o}=Ut(n||""),{data:a,isLoading:u}=Pt(n||""),s=K.useMemo(()=>a?a.map(r=>({id:r._id,name:r.name,dosage:r.dosage,frequency:r.frequency,route:r.route,startDate:r.startDate,endDate:r.endDate,indication:r.indication||"",prescriber:r.prescriber||"",allergyCheck:r.allergyCheck,status:r.status,patientId:r.patientId})):[],[a]),{data:h}=It(n||""),g=Wt(),M=zt(),W=Ft(),z=Ht(),E=(r,y)=>{L(y)},H=r=>{const{name:y,value:S}=r.target;if(y.includes(".")){const[he,Dt]=y.split(".");he==="allergyCheck"&&v({...c,allergyCheck:{...c.allergyCheck,[Dt]:S}})}else v({...c,[y]:S})},ae=r=>{const{name:y,checked:S}=r.target;y==="allergyCheck.status"?v({...c,allergyCheck:{...c.allergyCheck,status:S}}):y==="interactionCheck"&&P(S)},ie=r=>{v({...c,status:r.target.value})},de=r=>{v({...c,route:r.target.value})},ne=r=>{v({...c,frequency:r.target.value})},R=(r,y)=>{v({...c,[r]:y})},Z=r=>{const{name:y,value:S}=r.target;k({...p,[y]:y==="adherenceScore"||y==="pillCount"?parseInt(S,10)||0:S})},oe=r=>{r&&k({...p,refillDate:r})},le=()=>{const r={time:"09:00",days:["mon","tue","wed","thu","fri","sat","sun"],enabled:!0};C([...A,r])},ue=(r,y,S)=>{const he=[...A];y==="days"?he[r]={...he[r],[y]:S}:he[r]={...he[r],[y]:S},C(he)},De=r=>{const y=[...A];y.splice(r,1),C(y)},we=()=>{U(null),v(Je),C([]),b(0),m(!0)},me=r=>{var y,S;U(r.id),v({name:r.name,dosage:r.dosage,frequency:r.frequency,route:r.route,startDate:r.startDate?new Date(r.startDate):null,endDate:r.endDate?new Date(r.endDate):null,indication:r.indication,prescriber:r.prescriber,cost:((y=r.cost)==null?void 0:y.toString())||"",sellingPrice:((S=r.sellingPrice)==null?void 0:S.toString())||"",allergyCheck:r.allergyCheck,status:r.status,reminders:r.reminders||[]}),C(r.reminders||[]),b(0),m(!0)},fe=r=>{k({...p,medicationId:r}),B(!0)},xe=r=>{if(h){const y=h.filter(S=>S.medicationId===r);J(y.map(S=>({id:S._id,medicationId:S.medicationId,refillDate:S.refillDate,adherenceScore:S.adherenceScore,pillCount:S.pillCount??0,notes:S.notes??"",createdAt:S.createdAt}))),G(!0)}},ke=r=>{U(r),f(!0)},yt=async()=>{try{if(q&&s&&s.length>0){const y=s.map(S=>S.name);if(!F&&y.includes("Warfarin")&&c.name.includes("Aspirin")){V(["Potential interaction detected: Warfarin + Aspirin may increase bleeding risk"]);return}}const r={...c,startDate:c.startDate?c.startDate:void 0,endDate:c.endDate?c.endDate:void 0,cost:c.cost?parseFloat(c.cost):void 0,sellingPrice:c.sellingPrice?parseFloat(c.sellingPrice):void 0,reminders:A};if(F)await M.mutateAsync({id:F,data:r});else{const y={...r,patientId:n};await g.mutateAsync(y)}m(!1),v(Je),V([]),U(null)}catch(r){console.error("Error saving medication:",r)}},jt=async()=>{try{await z.mutateAsync({...p,medicationId:p.medicationId||"",patientId:n||"",adherenceScore:p.adherenceScore||100}),B(!1),k({medicationId:"",refillDate:new Date,adherenceScore:100,pillCount:0,notes:""})}catch(r){console.error("Error saving adherence record:",r)}},vt=async()=>{if(F)try{await W.mutateAsync({id:F,reason:"Medication archived by user"}),f(!1),U(null)}catch(r){console.error("Error archiving medication:",r)}};if(!n)return e.jsx($,{sx:{p:3},children:e.jsxs($e,{severity:"warning",children:[e.jsx(at,{children:"No Patient Selected"}),"Please select a patient to manage medications."]})});if(u)return e.jsx($,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:e.jsx(He,{})});const Be=(s==null?void 0:s.filter(r=>r.status==="active"))||[],Ne=(s==null?void 0:s.filter(r=>r.status==="archived"))||[],rt=(s==null?void 0:s.filter(r=>r.status==="cancelled"))||[],be=(()=>{if(!h||h.length===0)return 0;const r=h.reduce((y,S)=>y+S.adherenceScore,0);return Math.round(r/h.length)})();return e.jsxs($,{sx:{p:2},children:[x?e.jsx($,{sx:{display:"flex",justifyContent:"center",mb:3},children:e.jsx(He,{})}):o?e.jsx($e,{severity:"error",sx:{mb:3},children:"Error loading patient information. Please try refreshing the page."}):(st=Y==null?void 0:Y.data)!=null&&st.patient?e.jsx(se,{elevation:0,sx:{p:2,mb:3,backgroundColor:"primary.light",color:"primary.contrastText",borderRadius:2},children:e.jsxs($,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(St,{sx:{bgcolor:"primary.main",width:48,height:48,mr:2},children:e.jsx(Yt,{})}),e.jsxs($,{children:[e.jsxs(j,{variant:"h6",children:[Y.data.patient.firstName," ",Y.data.patient.lastName,Y.data.patient.otherNames?` ${Y.data.patient.otherNames}`:""]}),e.jsxs($,{sx:{display:"flex",flexWrap:"wrap",gap:3,mt:.5},children:[e.jsxs(j,{variant:"body2",children:[e.jsx("strong",{children:"MRN:"})," ",Y.data.patient.mrn||Y.data.patient._id]}),e.jsxs(j,{variant:"body2",children:[e.jsx("strong",{children:"DOB:"})," ",Y.data.patient.dob?new Date(Y.data.patient.dob).toLocaleDateString():"N/A"]}),e.jsxs(j,{variant:"body2",children:[e.jsx("strong",{children:"Gender:"})," ",Y.data.patient.gender||"N/A"]}),e.jsxs(j,{variant:"body2",children:[e.jsx("strong",{children:"Contact:"})," ",Y.data.patient.phone||Y.data.patient.email||"None"]})]})]})]})}):null,e.jsxs($,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(j,{variant:"h5",component:"h1",children:"Medication Management"}),e.jsx(te,{variant:"contained",color:"primary",startIcon:e.jsx(nt,{}),onClick:we,children:"Add Medication"})]}),e.jsxs(D,{container:!0,spacing:3,children:[e.jsx(D,{sx:{gridColumn:{xs:"span 12",md:"span 4"}},children:e.jsx(je,{children:e.jsxs(ve,{children:[e.jsx(j,{variant:"h6",component:"div",children:"Average Adherence Score"}),e.jsxs($,{sx:{display:"flex",alignItems:"center",mt:2},children:[e.jsx(He,{variant:"determinate",value:be,size:80,thickness:5,sx:{color:be>80?"success.main":be>50?"warning.main":"error.main"}}),e.jsxs(j,{variant:"h4",sx:{ml:2},color:be>80?"success.main":be>50?"warning.main":"error.main",children:[be,"%"]})]})]})})}),e.jsx(D,{sx:{gridColumn:{xs:"span 12",md:"span 4"}},children:e.jsx(je,{children:e.jsxs(ve,{children:[e.jsx(j,{variant:"h6",component:"div",children:"Active Medications"}),e.jsx(j,{variant:"h4",children:Be.length}),e.jsxs(j,{variant:"body2",color:"text.secondary",children:[Ne.length," archived"]})]})})}),e.jsx(D,{sx:{gridColumn:{xs:"span 12",md:"span 4"}},children:e.jsx(je,{children:e.jsxs(ve,{children:[e.jsx(j,{variant:"h6",component:"div",children:"Last Adherence Check"}),e.jsx(j,{variant:"h6",children:h&&h.length>0?new Date(h[h.length-1].createdAt).toLocaleDateString():"No records"})]})})})]}),e.jsxs(se,{sx:{mt:3},children:[e.jsx($,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Xe,{value:d,onChange:E,children:[e.jsx(ce,{label:"Active Medications"}),e.jsx(ce,{label:"Archived"}),e.jsx(ce,{label:"Cancelled"}),e.jsx(ce,{label:"Analytics"}),e.jsx(ce,{label:"Settings"})]})}),d===0&&e.jsx($,{sx:{p:2},children:Be.length===0?e.jsx(j,{variant:"body1",sx:{py:2},children:'No active medications found. Click "Add Medication" to get started.'}):e.jsx(Qe,{medications:Be,onEdit:me,onArchive:ke,onAddAdherence:fe,onViewHistory:xe})}),d===1&&e.jsx($,{sx:{p:2},children:Ne.length===0?e.jsx(j,{variant:"body1",sx:{py:2},children:"No archived medications found."}):e.jsx(Qe,{medications:Ne,onEdit:me,onArchive:ke,onAddAdherence:fe,onViewHistory:xe,isArchived:!0})}),d===2&&e.jsx($,{sx:{p:2},children:rt.length===0?e.jsx(j,{variant:"body1",sx:{py:2},children:"No cancelled medications found."}):e.jsx(Qe,{medications:rt,onEdit:me,onArchive:ke,onAddAdherence:fe,onViewHistory:xe,isArchived:!0})}),d===3&&e.jsx($,{sx:{p:2},children:e.jsx(ln,{patientId:n})}),d===4&&e.jsx($,{sx:{p:2},children:e.jsx(Bt,{patientId:n})})]}),e.jsxs(Oe,{open:T,onClose:()=>m(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(Le,{children:F?"Edit Medication":"Add New Medication"}),e.jsxs(Ye,{children:[e.jsxs(Xe,{value:i,onChange:(r,y)=>b(y),sx:{mb:2,borderBottom:1,borderColor:"divider"},children:[e.jsx(ce,{label:"Medication Details"}),e.jsx(ce,{label:"Reminders & Schedule"})]}),i===0&&e.jsxs(D,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(D,{sx:{gridColumn:{xs:"span 12",sm:"span 6"}},children:e.jsx(re,{name:"name",label:"Medication Name",value:c.name,onChange:H,fullWidth:!0,required:!0})}),e.jsx(D,{sx:{gridColumn:{xs:"span 12",sm:"span 6"}},children:e.jsx(re,{name:"dosage",label:"Dosage",value:c.dosage,onChange:H,fullWidth:!0,required:!0})}),e.jsx(D,{sx:{gridColumn:{xs:"span 12",sm:"span 6"}},children:e.jsxs(Se,{fullWidth:!0,children:[e.jsx(Te,{id:"frequency-label",children:"Frequency"}),e.jsx(Ae,{labelId:"frequency-label",id:"frequency",name:"frequency",value:c.frequency,onChange:ne,label:"Frequency",required:!0,children:on.map(r=>e.jsx(Q,{value:r.value,children:r.label},r.value))})]})}),e.jsx(D,{sx:{gridColumn:{xs:"span 12",sm:"span 6"}},children:e.jsxs(Se,{fullWidth:!0,children:[e.jsx(Te,{id:"route-label",children:"Route"}),e.jsx(Ae,{labelId:"route-label",id:"route",name:"route",value:c.route,onChange:de,label:"Route",required:!0,children:an.map(r=>e.jsx(Q,{value:r.value,children:r.label},r.value))})]})}),e.jsx(D,{sx:{gridColumn:{xs:"span 12",sm:"span 6"}},children:e.jsx(Re,{dateAdapter:Ke,children:e.jsx(_e,{label:"Start Date",value:c.startDate?N(c.startDate):null,onChange:r=>R("startDate",r?new Date(r.toString()):null),slotProps:{textField:{fullWidth:!0}}})})}),e.jsx(D,{sx:{gridColumn:{xs:"span 12",sm:"span 6"}},children:e.jsx(Re,{dateAdapter:Ke,children:e.jsx(_e,{label:"End Date (Optional)",value:c.endDate?N(c.endDate):null,onChange:r=>R("endDate",r?new Date(r.toString()):null),slotProps:{textField:{fullWidth:!0}}})})}),e.jsx(D,{sx:{gridColumn:"span 12"},children:e.jsx(re,{name:"indication",label:"Indication",value:c.indication,onChange:H,fullWidth:!0})}),e.jsx(D,{sx:{gridColumn:"span 12"},children:e.jsx(re,{name:"prescriber",label:"Prescriber",value:c.prescriber,onChange:H,fullWidth:!0})}),e.jsx(D,{sx:{gridColumn:{xs:"span 12",sm:"span 6"}},children:e.jsx(re,{name:"cost",label:"Cost Price (₦)",value:c.cost,onChange:H,fullWidth:!0,type:"number",inputProps:{min:0,step:"0.01"},helperText:"Optional - Cost price in Naira"})}),e.jsx(D,{sx:{gridColumn:{xs:"span 12",sm:"span 6"}},children:e.jsx(re,{name:"sellingPrice",label:"Selling Price (₦)",value:c.sellingPrice,onChange:H,fullWidth:!0,type:"number",inputProps:{min:0,step:"0.01"},helperText:"Optional - Selling price in Naira"})}),e.jsxs(D,{sx:{gridColumn:"span 12"},children:[e.jsx(Ee,{control:e.jsx(Ue,{checked:c.allergyCheck.status,onChange:ae,name:"allergyCheck.status",color:"primary"}),label:"Patient has allergies related to this medication"}),c.allergyCheck.status&&e.jsx(re,{name:"allergyCheck.details",label:"Allergy Details",value:c.allergyCheck.details,onChange:H,fullWidth:!0,margin:"normal"})]}),e.jsx(D,{sx:{gridColumn:"span 12"},children:e.jsx(Ee,{control:e.jsx(Ue,{checked:q,onChange:ae,name:"interactionCheck",color:"primary"}),label:"Check for drug interactions before saving"})}),F&&e.jsx(D,{sx:{gridColumn:"span 12"},children:e.jsxs(Se,{fullWidth:!0,children:[e.jsx(Te,{id:"status-label",children:"Status"}),e.jsxs(Ae,{labelId:"status-label",id:"status",name:"status",value:c.status,onChange:ie,label:"Status",children:[e.jsx(Q,{value:"active",children:"Active"}),e.jsx(Q,{value:"archived",children:"Archived"}),e.jsx(Q,{value:"cancelled",children:"Cancelled"})]})]})}),w.length>0&&e.jsx(D,{sx:{gridColumn:"span 12"},children:e.jsxs($e,{severity:"warning",sx:{mt:2},children:[e.jsx(at,{children:"Potential Interactions Detected"}),e.jsx("ul",{children:w.map((r,y)=>e.jsx("li",{children:r},y))}),e.jsx($,{sx:{mt:1},children:"Override and continue? Check with prescriber first."})]})})]}),i===1&&e.jsxs($,{sx:{p:1},children:[e.jsxs($,{sx:{display:"flex",justifyContent:"space-between",mb:2,alignItems:"center"},children:[e.jsx(j,{variant:"h6",children:"Medication Reminders"}),e.jsx(te,{variant:"outlined",startIcon:e.jsx(nt,{}),onClick:le,children:"Add Reminder"})]}),A.length===0?e.jsx($e,{severity:"info",sx:{my:2},children:"No reminders set for this medication. Add a reminder to help the patient stay on schedule."}):A.map((r,y)=>e.jsx(se,{sx:{p:2,mb:2,border:"1px solid",borderColor:"divider"},children:e.jsxs(D,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(D,{sx:{gridColumn:{xs:"span 12",sm:"span 3"}},children:e.jsx(re,{label:"Time",type:"time",fullWidth:!0,value:r.time,onChange:S=>ue(y,"time",S.target.value),InputLabelProps:{shrink:!0}})}),e.jsx(D,{sx:{gridColumn:{xs:"span 12",sm:"span 5"}},children:e.jsxs(Se,{fullWidth:!0,children:[e.jsx(Te,{id:`days-label-${y}`,children:"Days"}),e.jsxs(Ae,{labelId:`days-label-${y}`,multiple:!0,value:r.days,onChange:S=>ue(y,"days",S.target.value),renderValue:S=>S.map(he=>he.toUpperCase()).join(", "),children:[e.jsx(Q,{value:"mon",children:"Monday"}),e.jsx(Q,{value:"tue",children:"Tuesday"}),e.jsx(Q,{value:"wed",children:"Wednesday"}),e.jsx(Q,{value:"thu",children:"Thursday"}),e.jsx(Q,{value:"fri",children:"Friday"}),e.jsx(Q,{value:"sat",children:"Saturday"}),e.jsx(Q,{value:"sun",children:"Sunday"})]})]})}),e.jsx(D,{sx:{gridColumn:{xs:"span 6",sm:"span 3"}},children:e.jsx(Ee,{control:e.jsx(Ue,{checked:r.enabled,onChange:S=>ue(y,"enabled",S.target.checked)}),label:"Enabled"})}),e.jsx(D,{sx:{gridColumn:{xs:"span 6",sm:"span 1"}},children:e.jsx(Tt,{color:"error",onClick:()=>De(y),children:e.jsx(ut,{})})}),e.jsx(D,{sx:{gridColumn:"span 12"},children:e.jsx(re,{label:"Notes",fullWidth:!0,placeholder:"Additional instructions for this reminder...",value:r.notes||"",onChange:S=>ue(y,"notes",S.target.value)})})]})},y))]})]}),e.jsxs(Pe,{children:[e.jsx(te,{onClick:()=>m(!1),children:"Cancel"}),e.jsx(te,{onClick:yt,variant:"contained",color:"primary",children:"Save"})]})]}),e.jsxs(Oe,{open:O,onClose:()=>B(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Le,{children:"Record Medication Adherence"}),e.jsx(Ye,{children:e.jsxs(D,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(D,{sx:{gridColumn:"span 12"},children:e.jsx(Re,{dateAdapter:Ke,children:e.jsx(_e,{label:"Refill Date",value:N(p.refillDate),onChange:r=>oe(r?new Date(r.toString()):null),slotProps:{textField:{fullWidth:!0}}})})}),e.jsxs(D,{size:{xs:12},children:[e.jsx(re,{name:"adherenceScore",label:"Adherence Score (%)",type:"number",value:p.adherenceScore,onChange:Z,fullWidth:!0,inputProps:{min:0,max:100}}),e.jsx(At,{children:"0% = No adherence, 100% = Perfect adherence"})]}),e.jsx(D,{size:{xs:12},children:e.jsx(re,{name:"pillCount",label:"Remaining Pill Count",type:"number",value:p.pillCount,onChange:Z,fullWidth:!0,inputProps:{min:0}})}),e.jsx(D,{size:{xs:12},children:e.jsx(re,{name:"notes",label:"Notes",value:p.notes,onChange:Z,fullWidth:!0,multiline:!0,rows:3})})]})}),e.jsxs(Pe,{children:[e.jsx(te,{onClick:()=>B(!1),children:"Cancel"}),e.jsx(te,{onClick:jt,variant:"contained",color:"primary",children:"Save"})]})]}),e.jsxs(Oe,{open:_,onClose:()=>G(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(Le,{children:"Medication Adherence History"}),e.jsx(Ye,{children:ee.length===0?e.jsx(j,{children:"No adherence records found for this medication."}):e.jsx($,{children:ee.map(r=>e.jsxs(se,{sx:{p:2,my:1},children:[e.jsx(j,{variant:"subtitle1",children:new Date(r.refillDate).toLocaleDateString()}),e.jsxs($,{sx:{display:"flex",alignItems:"center",mt:1},children:[e.jsx(j,{variant:"body2",sx:{mr:1},children:"Adherence Score:"}),e.jsx(et,{icon:r.adherenceScore>80?e.jsx(kt,{}):r.adherenceScore>50?e.jsx(tt,{}):e.jsx(tt,{color:"error"}),label:`${r.adherenceScore}%`,color:r.adherenceScore>80?"success":r.adherenceScore>50?"warning":"error"})]}),e.jsxs(j,{variant:"body2",sx:{mt:1},children:["Pill Count: ",r.pillCount]}),r.notes&&e.jsxs(j,{variant:"body2",sx:{mt:1},children:["Notes: ",r.notes]})]},r.id))})}),e.jsx(Pe,{children:e.jsx(te,{onClick:()=>G(!1),children:"Close"})})]}),e.jsxs(Oe,{open:X,onClose:()=>f(!1),children:[e.jsx(Le,{children:"Archive Medication"}),e.jsx(Ye,{children:e.jsx(j,{children:"Are you sure you want to archive this medication? This will mark it as no longer active, but the record will be preserved for historical purposes."})}),e.jsxs(Pe,{children:[e.jsx(te,{onClick:()=>f(!1),children:"Cancel"}),e.jsx(te,{onClick:vt,variant:"contained",color:"primary",children:"Archive"})]})]})]})},Qe=({medications:I,onEdit:t,onArchive:n,onAddAdherence:d,onViewHistory:L,isArchived:T=!1,showStatus:m=!1})=>e.jsx($,{children:I.map(i=>e.jsx(se,{sx:{p:2,mb:2},children:e.jsxs($,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs($,{children:[e.jsx(j,{variant:"h6",component:"div",children:i.name}),e.jsxs(j,{variant:"body1",color:"text.secondary",children:[i.dosage," - ",i.frequency," (",i.route,")"]}),e.jsxs(j,{variant:"body2",children:["Start Date:"," ",i.startDate?new Date(i.startDate).toLocaleDateString():"Not specified"]}),i.endDate&&e.jsxs(j,{variant:"body2",children:["End Date: ",new Date(i.endDate).toLocaleDateString()]}),i.reminders&&i.reminders.length>0&&e.jsxs($,{sx:{mt:1,display:"flex",alignItems:"center"},children:[e.jsx($t,{color:"info",fontSize:"small",sx:{mr:.5}}),e.jsxs(j,{variant:"body2",color:"info.main",children:[i.reminders.length," Reminder",i.reminders.length>1?"s":""," set"]})]}),m&&e.jsx(et,{label:i.status.toUpperCase(),color:i.status==="active"?"success":i.status==="archived"?"default":"error",size:"small",sx:{mt:1}}),i.allergyCheck.status&&e.jsx(et,{icon:e.jsx(tt,{}),label:"Allergy Alert",color:"warning",size:"small",sx:{mt:1,ml:m?1:0}})]}),e.jsxs($,{children:[e.jsx(te,{startIcon:e.jsx(Ot,{}),onClick:()=>t(i),size:"small",sx:{mr:1},children:"Edit"}),!T&&e.jsxs(e.Fragment,{children:[e.jsx(te,{startIcon:e.jsx(Lt,{}),onClick:()=>L(i.id),size:"small",sx:{mr:1},children:"History"}),e.jsx(te,{startIcon:e.jsx(nt,{}),onClick:()=>d(i.id),size:"small",sx:{mr:1},children:"Add Adherence"}),e.jsx(te,{startIcon:e.jsx(ut,{}),onClick:()=>n(i.id),size:"small",color:"error",children:"Archive"})]})]})]})},i.id))}),Fe=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"],ln=({patientId:I})=>{const[t,n]=K.useState("6months"),[d,L]=K.useState(0),{data:T,isLoading:m}=Nt(I,t),{data:i,isLoading:b}=Et(I),{data:A,isLoading:C}=Rt(I),{data:O,isLoading:B}=_t(I),_=p=>{n(p.target.value)},G=(p,k)=>{L(k)};if(m||b||C||B)return e.jsx($,{sx:{display:"flex",justifyContent:"center",p:3},children:e.jsx(He,{})});const X=T||{monthlyAdherence:[{month:"Jan",adherence:75},{month:"Feb",adherence:82},{month:"Mar",adherence:78},{month:"Apr",adherence:85},{month:"May",adherence:90},{month:"Jun",adherence:88}],averageAdherence:83,trendDirection:"up",complianceDays:[{day:"Mon",count:24},{day:"Tue",count:26},{day:"Wed",count:28},{day:"Thu",count:25},{day:"Fri",count:22},{day:"Sat",count:18},{day:"Sun",count:20}]},f=i||{medicationsByCategory:[{category:"Cardiovascular",count:5},{category:"Analgesic",count:3},{category:"Antibiotic",count:2},{category:"Respiratory",count:4},{category:"CNS",count:1}],medicationsByRoute:[{route:"Oral",count:10},{route:"Injection",count:2},{route:"Topical",count:1},{route:"Inhaled",count:2}],prescriptionFrequency:[{month:"Jan",count:3},{month:"Feb",count:2},{month:"Mar",count:4},{month:"Apr",count:1},{month:"May",count:5},{month:"Jun",count:3}],topPrescribers:[{prescriber:"Dr. Smith",count:8},{prescriber:"Dr. Johnson",count:4},{prescriber:"Dr. Williams",count:3}]},c=A||{severityDistribution:[{severity:"Minor",count:7},{severity:"Moderate",count:4},{severity:"Severe",count:1}],interactionTrends:[{month:"Jan",count:2},{month:"Feb",count:3},{month:"Mar",count:1},{month:"Apr",count:4},{month:"May",count:2},{month:"Jun",count:0}]},v=O||{activeCount:8,archivedCount:3,cancelledCount:1,adherenceRate:85,interactionCount:12,mostCommonCategory:"Cardiovascular",mostCommonRoute:"Oral",lastUpdated:new Date().toISOString()};return e.jsxs($,{sx:{width:"100%"},children:[e.jsx(j,{variant:"h5",gutterBottom:!0,children:"Medication Analytics Dashboard"}),e.jsxs(D,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(D,{sx:{gridColumn:{xs:"span 6",sm:"span 3"}},children:e.jsx(je,{children:e.jsxs(ve,{children:[e.jsx(j,{variant:"subtitle2",color:"text.secondary",children:"Active Medications"}),e.jsx(j,{variant:"h4",children:v.activeCount})]})})}),e.jsx(D,{sx:{gridColumn:{xs:"span 6",sm:"span 3"}},children:e.jsx(je,{children:e.jsxs(ve,{children:[e.jsx(j,{variant:"subtitle2",color:"text.secondary",children:"Avg. Adherence"}),e.jsxs(j,{variant:"h4",children:[v.adherenceRate,"%"]})]})})}),e.jsx(D,{sx:{gridColumn:{xs:"span 6",sm:"span 3"}},children:e.jsx(je,{children:e.jsxs(ve,{children:[e.jsx(j,{variant:"subtitle2",color:"text.secondary",children:"Potential Interactions"}),e.jsx(j,{variant:"h4",children:v.interactionCount})]})})}),e.jsx(D,{sx:{gridColumn:{xs:"span 6",sm:"span 3"}},children:e.jsx(je,{children:e.jsxs(ve,{children:[e.jsx(j,{variant:"subtitle2",color:"text.secondary",children:"Most Common"}),e.jsx(j,{variant:"h6",children:v.mostCommonCategory})]})})})]}),e.jsx($,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Xe,{value:d,onChange:G,children:[e.jsx(ce,{label:"Adherence Trends"}),e.jsx(ce,{label:"Prescription Patterns"}),e.jsx(ce,{label:"Interactions"})]})}),d===0&&e.jsxs($,{sx:{p:2},children:[e.jsxs($,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(j,{variant:"h6",children:"Medication Adherence Over Time"}),e.jsxs(Se,{size:"small",sx:{minWidth:150},children:[e.jsx(Te,{id:"adherence-period-label",children:"Period"}),e.jsxs(Ae,{labelId:"adherence-period-label",value:t,label:"Period",onChange:_,children:[e.jsx(Q,{value:"3months",children:"Last 3 Months"}),e.jsx(Q,{value:"6months",children:"Last 6 Months"}),e.jsx(Q,{value:"1year",children:"Last Year"})]})]})]}),e.jsxs(se,{sx:{p:2,mb:3},children:[e.jsx(j,{variant:"subtitle1",gutterBottom:!0,children:"Monthly Adherence Rates"}),e.jsx(pe,{width:"100%",height:300,children:e.jsxs(it,{data:X.monthlyAdherence,children:[e.jsx(Ie,{strokeDasharray:"3 3"}),e.jsx(We,{dataKey:"month"}),e.jsx(ze,{domain:[0,100]}),e.jsx(ge,{}),e.jsx(ye,{}),e.jsx(ot,{type:"monotone",dataKey:"adherence",stroke:"#8884d8",activeDot:{r:8},name:"Adherence %"})]})})]}),e.jsxs(se,{sx:{p:2},children:[e.jsx(j,{variant:"subtitle1",gutterBottom:!0,children:"Medication Compliance by Day of Week"}),e.jsx(pe,{width:"100%",height:300,children:e.jsxs(lt,{data:X.complianceDays,children:[e.jsx(Ie,{strokeDasharray:"3 3"}),e.jsx(We,{dataKey:"day"}),e.jsx(ze,{}),e.jsx(ge,{}),e.jsx(ye,{}),e.jsx(ct,{dataKey:"count",fill:"#82ca9d",name:"Compliant Days"})]})})]})]}),d===1&&e.jsx($,{sx:{p:2},children:e.jsxs(D,{container:!0,spacing:3,children:[e.jsx(D,{sx:{gridColumn:{xs:"span 12",md:"span 6"}},children:e.jsxs(se,{sx:{p:2,height:"100%"},children:[e.jsx(j,{variant:"subtitle1",gutterBottom:!0,children:"Medications by Category"}),e.jsx(pe,{width:"100%",height:300,children:e.jsxs(qe,{children:[e.jsx(Ge,{data:f.medicationsByCategory,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"count",nameKey:"category",label:({name:p,percent:k})=>`${p}: ${k?(k*100).toFixed(0):0}%`,children:f.medicationsByCategory.map((p,k)=>e.jsx(Ve,{fill:Fe[k%Fe.length]},`cell-${k}`))}),e.jsx(ge,{}),e.jsx(ye,{})]})})]})}),e.jsx(D,{sx:{gridColumn:{xs:"span 12",md:"span 6"}},children:e.jsxs(se,{sx:{p:2,height:"100%"},children:[e.jsx(j,{variant:"subtitle1",gutterBottom:!0,children:"Medications by Route"}),e.jsx(pe,{width:"100%",height:300,children:e.jsxs(qe,{children:[e.jsx(Ge,{data:f.medicationsByRoute,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"count",nameKey:"route",label:({name:p,percent:k})=>`${p}: ${k?(k*100).toFixed(0):0}%`,children:f.medicationsByRoute.map((p,k)=>e.jsx(Ve,{fill:Fe[k%Fe.length]},`cell-${k}`))}),e.jsx(ge,{}),e.jsx(ye,{})]})})]})}),e.jsx(D,{sx:{gridColumn:"span 12"},children:e.jsxs(se,{sx:{p:2},children:[e.jsx(j,{variant:"subtitle1",gutterBottom:!0,children:"Prescription Frequency Over Time"}),e.jsx(pe,{width:"100%",height:300,children:e.jsxs(lt,{data:f.prescriptionFrequency,children:[e.jsx(Ie,{strokeDasharray:"3 3"}),e.jsx(We,{dataKey:"month"}),e.jsx(ze,{}),e.jsx(ge,{}),e.jsx(ye,{}),e.jsx(ct,{dataKey:"count",fill:"#8884d8",name:"New Prescriptions"})]})})]})})]})}),d===2&&e.jsx($,{sx:{p:2},children:e.jsxs(D,{container:!0,spacing:3,children:[e.jsx(D,{sx:{gridColumn:{xs:"span 12",md:"span 6"}},children:e.jsxs(se,{sx:{p:2,height:"100%"},children:[e.jsx(j,{variant:"subtitle1",gutterBottom:!0,children:"Interaction Severity Distribution"}),e.jsx(pe,{width:"100%",height:300,children:e.jsxs(qe,{children:[e.jsx(Ge,{data:c.severityDistribution,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"count",nameKey:"severity",label:({name:p,percent:k})=>`${p}: ${k?(k*100).toFixed(0):0}%`,children:c.severityDistribution.map((p,k)=>e.jsx(Ve,{fill:p.severity==="Severe"?"#ff6b6b":p.severity==="Moderate"?"#feca57":"#1dd1a1"},`cell-${k}`))}),e.jsx(ge,{}),e.jsx(ye,{})]})})]})}),e.jsx(D,{sx:{gridColumn:{xs:"span 12",md:"span 6"}},children:e.jsxs(se,{sx:{p:2,height:"100%"},children:[e.jsx(j,{variant:"subtitle1",gutterBottom:!0,children:"Interaction Trends Over Time"}),e.jsx(pe,{width:"100%",height:300,children:e.jsxs(it,{data:c.interactionTrends,children:[e.jsx(Ie,{strokeDasharray:"3 3"}),e.jsx(We,{dataKey:"month"}),e.jsx(ze,{}),e.jsx(ge,{}),e.jsx(ye,{}),e.jsx(ot,{type:"monotone",dataKey:"count",stroke:"#ff6b6b",activeDot:{r:8},name:"Interactions"})]})})]})})]})})]})};export{$n as default};
