import{c as E,j as e,a3 as R,g as k,r as a,a_ as x,C as u,b as m,ab as H,T as s,b9 as T,B as h,h as i,w as p,a0 as V,L as F,n as j,ar as y,p as f,c9 as w}from"./index-B_pWc9hu.js";import{H as G}from"./Home-C8eDz3RN.js";const M=E(e.jsx("path",{d:"M18 17H6v-2h12zm0-4H6v-2h12zm0-4H6V7h12zM3 22l1.5-1.5L6 22l1.5-1.5L9 22l1.5-1.5L12 22l1.5-1.5L15 22l1.5-1.5L18 22l1.5-1.5L21 22V2l-1.5 1.5L18 2l-1.5 1.5L15 2l-1.5 1.5L12 2l-1.5 1.5L9 2 7.5 3.5 6 2 4.5 3.5 3 2z"})),U=()=>{const[g]=R(),c=k(),[D,o]=a.useState(!0),[I,z]=a.useState(!1),[v,r]=a.useState(""),[n,B]=a.useState(null),b=g.get("reference"),S=g.get("trxref");a.useEffect(()=>{(async()=>{var P,C;const l=b||S;if(!l){r("No payment reference found"),o(!1);return}try{const t=await w.get(`/api/subscriptions/verify-payment?reference=${l}`);if(!t.data.success){r(t.data.message||"Payment verification failed"),o(!1);return}const d=await w.post("/api/subscriptions/success",{paymentReference:l},{withCredentials:!0});d.data.success?(z(!0),B(d.data.data)):r(d.data.message||"Failed to activate subscription")}catch(t){console.error("Error verifying payment:",t),r(((C=(P=t.response)==null?void 0:P.data)==null?void 0:C.message)||"Something went wrong. Please try again.")}finally{o(!1)}})()},[b,S]);const L=()=>{c("/dashboard")},A=()=>{c("/subscription-management")};return D?e.jsx(x,{maxWidth:"sm",sx:{mt:8,textAlign:"center"},children:e.jsx(u,{children:e.jsxs(m,{sx:{py:6},children:[e.jsx(H,{size:60,sx:{mb:3}}),e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Processing Your Payment"}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Please wait while we verify your payment and activate your subscription..."})]})})}):v?e.jsx(x,{maxWidth:"sm",sx:{mt:8},children:e.jsx(u,{children:e.jsxs(m,{sx:{textAlign:"center",py:6},children:[e.jsx(T,{sx:{fontSize:80,color:"error.main",mb:2}}),e.jsx(s,{variant:"h5",gutterBottom:!0,children:"Payment Failed"}),e.jsx(s,{variant:"body1",color:"text.secondary",paragraph:!0,children:v}),e.jsxs(h,{sx:{mt:3},children:[e.jsx(i,{variant:"contained",onClick:()=>c("/subscription-management"),sx:{mr:2},children:"Try Again"}),e.jsx(i,{variant:"outlined",onClick:L,children:"Go to Dashboard"})]})]})})}):I?e.jsx(x,{maxWidth:"sm",sx:{mt:8},children:e.jsx(u,{children:e.jsxs(m,{sx:{textAlign:"center",py:6},children:[e.jsx(p,{sx:{fontSize:80,color:"success.main",mb:2}}),e.jsx(s,{variant:"h4",gutterBottom:!0,color:"success.main",children:"Payment Successful!"}),e.jsx(s,{variant:"body1",color:"text.secondary",paragraph:!0,children:"Your subscription has been activated successfully. You now have access to all premium features."}),n&&e.jsxs(e.Fragment,{children:[e.jsx(V,{sx:{my:3}}),e.jsxs(h,{sx:{textAlign:"left"},children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Subscription Details"}),e.jsxs(F,{dense:!0,children:[e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(M,{})}),e.jsx(f,{primary:"Plan",secondary:n.planName||"Premium Plan"})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(p,{})}),e.jsx(f,{primary:"Status",secondary:"Active"})]}),n.endDate&&e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(p,{})}),e.jsx(f,{primary:"Valid Until",secondary:new Date(n.endDate).toLocaleDateString()})]})]})]})]}),e.jsxs(h,{sx:{mt:4,display:"flex",gap:2,justifyContent:"center"},children:[e.jsx(i,{variant:"contained",startIcon:e.jsx(G,{}),onClick:L,children:"Go to Dashboard"}),e.jsx(i,{variant:"outlined",onClick:A,children:"Manage Subscription"})]})]})})}):null};export{U as default};
