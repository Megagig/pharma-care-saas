import{c as ae,j as e,r as x,bI as le,B as n,ab as oe,D as Te,a2 as Ee,T as s,h as y,R as ce,G as o,C as p,b as g,cs as ie,a0 as ee,L as ye,n as be,p as fe,l as z,w as _e,O as tt,W as It,b9 as st,ce as Ae,a7 as q,a8 as G,a9 as J,f as S,P as De,J as kt,bH as Ne,Q as re,y as ze,aR as K,aS as Y,aT as X,a5 as F,aU as Z,bx as Re,K as ke,bw as At,ai as ne,I as M,d as xe,V as Dt,bP as Rt,ct as Ye,bn as rt,bo as V,x as Xe,b4 as Pt,t as Lt,U as Bt,a1 as Tt,ak as de,bs as Wt,bt as Ut,aX as Ft,bu as Ot}from"./index-B_pWc9hu.js";import{E as Pe}from"./Edit-DD3Q49Z-.js";import{C as Et}from"./Cancel-DzpQiNXV.js";import{D as Nt}from"./Download-DRMVM3Bm.js";import{P as _t}from"./PlaylistAddCheck-ChtXDGZ6.js";import{g as zt,d as $t,e as Ht,a as Vt,B as qt,u as Gt,s as Jt,f as Qt,r as Kt,b as Yt,h as Xt}from"./BulkOperationProgress-DoxGacTl.js";import{T as he,a as ue,b as me,c as N,d as je}from"./TableRow-BGzfcKex.js";import{T as l}from"./TableCell-DCrr5aWG.js";import{T as nt}from"./TrendingDown-B2R8u3Lo.js";import{P as Ie}from"./PlayArrow-MruisKZg.js";import{I as Oe}from"./PersonAdd-BOMx32z9.js";import{S as $e}from"./Search-C2mZoRVv.js";import{A as Le}from"./Add-D5-B7xRD.js";import{S as Be}from"./Switch-DtQ0auD3.js";import{D as it}from"./Delete-BIyg2wQJ.js";import{M as Ze}from"./AttachMoney-81FhkR8A.js";import{T as Zt}from"./TablePagination-DuttMPh4.js";import"./apiClient-BShn_SjK.js";import"./ExpandLess-CfW7CJI2.js";import"./LastPage-CY6t_Uvn.js";const Mt=ae(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12m8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8"})),es=ae(e.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm-1 4 6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2zm-1 7h5.5L14 6.5z"})),Me=ae(e.jsx("path",{d:"M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2zm10 14.5V20H8v-3.5l4-4zm-4-5-4-4V4h8v3.5z"})),ts=ae(e.jsx("path",{d:"M11 2v20c-5.07-.5-9-4.79-9-10s3.93-9.5 9-10m2.03 0v8.99H22c-.47-4.74-4.24-8.52-8.97-8.99m0 11.01V22c4.74-.47 8.5-4.25 8.97-8.99z"})),ss=ae(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m5 11H7v-2h10z"})),at=ae(e.jsx("path",{d:"M16 17.01V10h-2v7.01h-3L15 21l4-3.99zM9 3 5 6.99h3V14h2V6.99h3z"})),et=ae(e.jsx("path",{d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8"})),ve=ae(e.jsx("path",{d:"M10 15h5.88c.27-.31.67-.5 1.12-.5.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5c-.44 0-.84-.19-1.12-.5H11.9c-.46 2.28-2.48 4-4.9 4-2.76 0-5-2.24-5-5 0-2.42 1.72-4.44 4-4.9v2.07c-1.16.41-2 1.53-2 2.83 0 1.65 1.35 3 3 3s3-1.35 3-3zm2.5-11c1.65 0 3 1.35 3 3h2c0-2.76-2.24-5-5-5s-5 2.24-5 5c0 1.43.6 2.71 1.55 3.62l-2.35 3.9c-.68.14-1.2.75-1.2 1.48 0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5c0-.16-.02-.31-.07-.45l3.38-5.63C10.49 9.61 9.5 8.42 9.5 7c0-1.65 1.35-3 3-3m4.5 9c-.64 0-1.23.2-1.72.54l-3.05-5.07C11.53 8.35 11 7.74 11 7c0-.83.67-1.5 1.5-1.5S14 6.17 14 7c0 .15-.02.29-.06.43l2.19 3.65c.28-.05.57-.08.87-.08 2.76 0 5 2.24 5 5s-2.24 5-5 5c-1.85 0-3.47-1.01-4.33-2.5h2.67c.48.32 1.05.5 1.66.5 1.65 0 3-1.35 3-3s-1.35-3-3-3"})),rs=()=>{const[w,f]=x.useState(!0),[t,L]=x.useState(null),[v,D]=x.useState([]),[C,B]=x.useState(null),j=le(i=>i.addNotification),O=async()=>{try{f(!0),B(null);const i={totalEvents:124,criticalEvents:3,warningEvents:12,resolvedEvents:89,activeThreats:1},m=[{id:"1",type:"failed_login",severity:"high",timestamp:new Date(Date.now()-36e5).toISOString(),user:"admin@example.com",ip:"192.168.1.100",location:"Lagos, Nigeria",description:"Multiple failed login attempts detected"},{id:"2",type:"suspicious_activity",severity:"critical",timestamp:new Date(Date.now()-72e5).toISOString(),user:"user@example.com",ip:"10.0.0.5",location:"Unknown",description:"Unusual data access pattern detected"},{id:"3",type:"configuration_change",severity:"medium",timestamp:new Date(Date.now()-864e5).toISOString(),user:"superadmin@example.com",ip:"192.168.1.50",location:"Abuja, Nigeria",description:"Security settings updated"}];L(i),D(m)}catch{B("Failed to load security data"),j({type:"error",title:"Error",message:"Failed to load security dashboard data"})}finally{f(!1)}};x.useEffect(()=>{O()},[]);const I=i=>{switch(i){case"critical":return"error";case"high":return"warning";case"medium":return"info";case"low":return"success";default:return"default"}},W=i=>{switch(i){case"failed_login":return e.jsx(st,{});case"suspicious_activity":return e.jsx(It,{});case"configuration_change":return e.jsx(tt,{});default:return e.jsx(Ee,{})}};return w?e.jsx(n,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:e.jsx(oe,{})}):C?e.jsx(Te,{severity:"error",sx:{m:2},children:C}):e.jsxs(n,{children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Ee,{sx:{mr:1,color:"primary.main"}}),e.jsx(s,{variant:"h5",component:"h1",children:"Security Dashboard"})]}),e.jsx(y,{variant:"outlined",startIcon:e.jsx(ce,{}),onClick:O,children:"Refresh"})]}),e.jsxs(o,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(o,{item:!0,xs:12,sm:6,md:2.4,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"primary.main",gutterBottom:!0,children:(t==null?void 0:t.totalEvents)||0}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Total Events"})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:2.4,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"error.main",gutterBottom:!0,children:(t==null?void 0:t.criticalEvents)||0}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Critical Alerts"})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:2.4,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"warning.main",gutterBottom:!0,children:(t==null?void 0:t.warningEvents)||0}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Warnings"})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:2.4,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"success.main",gutterBottom:!0,children:(t==null?void 0:t.resolvedEvents)||0}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Resolved"})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:2.4,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"info.main",gutterBottom:!0,children:(t==null?void 0:t.activeThreats)||0}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Active Threats"})]})})})]}),e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{item:!0,xs:12,md:8,children:e.jsxs(p,{children:[e.jsx(ie,{title:"Recent Security Events",subheader:"Latest security activities and alerts"}),e.jsx(ee,{}),e.jsx(g,{children:e.jsx(ye,{children:v.map(i=>e.jsxs(be,{sx:{alignItems:"flex-start"},children:[e.jsx(n,{sx:{mr:2,mt:.5},children:W(i.type)}),e.jsx(fe,{primary:e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:.5},children:[e.jsx(s,{variant:"subtitle2",sx:{mr:1},children:i.description}),e.jsx(z,{label:i.severity,size:"small",color:I(i.severity)})]}),secondary:e.jsxs(n,{children:[e.jsxs(s,{variant:"body2",color:"textSecondary",children:["User: ",i.user," • IP: ",i.ip," •"," ",i.location]}),e.jsx(s,{variant:"caption",color:"textSecondary",children:new Date(i.timestamp).toLocaleString()})]})})]},i.id))})})]})}),e.jsxs(o,{item:!0,xs:12,md:4,children:[e.jsxs(p,{sx:{mb:3},children:[e.jsx(ie,{title:"Security Status",subheader:"Current system security posture"}),e.jsx(ee,{}),e.jsx(g,{children:e.jsxs(n,{sx:{textAlign:"center",py:2},children:[e.jsx(_e,{sx:{fontSize:60,color:"success.main",mb:1}}),e.jsx(s,{variant:"h6",gutterBottom:!0,children:"System Secure"}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"No critical vulnerabilities detected"})]})})]}),e.jsxs(p,{children:[e.jsx(ie,{title:"Quick Actions",subheader:"Security management tools"}),e.jsx(ee,{}),e.jsx(g,{children:e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsx(y,{variant:"outlined",fullWidth:!0,children:"View All Alerts"}),e.jsx(y,{variant:"outlined",fullWidth:!0,children:"Security Settings"}),e.jsx(y,{variant:"outlined",fullWidth:!0,children:"Audit Logs"}),e.jsx(y,{variant:"outlined",fullWidth:!0,color:"error",children:"Emergency Lockdown"})]})})]})]})]})]})},ns=()=>{const[w,f]=x.useState(!0),[t,L]=x.useState(null),[v,D]=x.useState("month"),[C,B]=x.useState(null),j=le(b=>b.addNotification),O=async()=>{try{f(!0),B(null),L({currentPeriod:{period:"This Month",users:1240,activeUsers:980,subscriptions:850,activeSubscriptions:720,revenue:45e3,apiCalls:125e3,storageUsed:245},previousPeriod:{period:"Last Month",users:1120,activeUsers:890,subscriptions:780,activeSubscriptions:650,revenue:38e3,apiCalls:11e4,storageUsed:210},growth:{users:10.7,activeUsers:10.1,subscriptions:9,revenue:18.4,apiCalls:13.6}})}catch{B("Failed to load usage data"),j({type:"error",title:"Error",message:"Failed to load usage monitoring data"})}finally{f(!1)}};x.useEffect(()=>{O()},[v]);const I=b=>new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(b),W=b=>b>=1e6?(b/1e6).toFixed(1)+"M":b>=1e3?(b/1e3).toFixed(1)+"K":b.toString(),i=b=>b>0?e.jsx(ze,{sx:{color:"success.main",fontSize:"1rem"}}):b<0?e.jsx(nt,{sx:{color:"error.main",fontSize:"1rem"}}):null,m=b=>b>0?"success.main":b<0?"error.main":"text.primary";return w?e.jsx(n,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:e.jsx(oe,{})}):C?e.jsx(Te,{severity:"error",sx:{m:2},children:C}):e.jsxs(n,{children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Ae,{sx:{mr:1,color:"primary.main"}}),e.jsx(s,{variant:"h5",component:"h1",children:"Usage Monitoring & Analytics"})]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(q,{size:"small",sx:{minWidth:120},children:[e.jsx(G,{children:"Period"}),e.jsxs(J,{value:v,label:"Period",onChange:b=>D(b.target.value),children:[e.jsx(S,{value:"day",children:"Today"}),e.jsx(S,{value:"week",children:"This Week"}),e.jsx(S,{value:"month",children:"This Month"}),e.jsx(S,{value:"year",children:"This Year"})]})]}),e.jsx(y,{variant:"outlined",startIcon:e.jsx(ce,{}),onClick:O,children:"Refresh"})]})]}),e.jsxs(o,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(o,{item:!0,xs:12,sm:6,md:2.4,children:e.jsx(p,{children:e.jsxs(g,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(De,{sx:{mr:1,color:"primary.main"}}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Total Users"})]}),e.jsx(s,{variant:"h4",gutterBottom:!0,children:(t==null?void 0:t.currentPeriod.users.toLocaleString())||"0"}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[i((t==null?void 0:t.growth.users)||0),e.jsxs(s,{variant:"body2",sx:{color:m((t==null?void 0:t.growth.users)||0),ml:.5},children:[(t==null?void 0:t.growth.users.toFixed(1))||"0","%"]}),e.jsxs(s,{variant:"body2",color:"textSecondary",sx:{ml:.5},children:["vs ",t==null?void 0:t.previousPeriod.period]})]})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:2.4,children:e.jsx(p,{children:e.jsxs(g,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(De,{sx:{mr:1,color:"success.main"}}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Active Users"})]}),e.jsx(s,{variant:"h4",gutterBottom:!0,children:(t==null?void 0:t.currentPeriod.activeUsers.toLocaleString())||"0"}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[i((t==null?void 0:t.growth.activeUsers)||0),e.jsxs(s,{variant:"body2",sx:{color:m((t==null?void 0:t.growth.activeUsers)||0),ml:.5},children:[(t==null?void 0:t.growth.activeUsers.toFixed(1))||"0","%"]}),e.jsxs(s,{variant:"body2",color:"textSecondary",sx:{ml:.5},children:["vs ",t==null?void 0:t.previousPeriod.period]})]})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:2.4,children:e.jsx(p,{children:e.jsxs(g,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(kt,{sx:{mr:1,color:"info.main"}}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Subscriptions"})]}),e.jsx(s,{variant:"h4",gutterBottom:!0,children:(t==null?void 0:t.currentPeriod.subscriptions.toLocaleString())||"0"}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[i((t==null?void 0:t.growth.subscriptions)||0),e.jsxs(s,{variant:"body2",sx:{color:m((t==null?void 0:t.growth.subscriptions)||0),ml:.5},children:[(t==null?void 0:t.growth.subscriptions.toFixed(1))||"0","%"]}),e.jsxs(s,{variant:"body2",color:"textSecondary",sx:{ml:.5},children:["vs ",t==null?void 0:t.previousPeriod.period]})]})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:2.4,children:e.jsx(p,{children:e.jsxs(g,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Ne,{sx:{mr:1,color:"warning.main"}}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Revenue"})]}),e.jsx(s,{variant:"h4",gutterBottom:!0,children:I((t==null?void 0:t.currentPeriod.revenue)||0)}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[i((t==null?void 0:t.growth.revenue)||0),e.jsxs(s,{variant:"body2",sx:{color:m((t==null?void 0:t.growth.revenue)||0),ml:.5},children:[(t==null?void 0:t.growth.revenue.toFixed(1))||"0","%"]}),e.jsxs(s,{variant:"body2",color:"textSecondary",sx:{ml:.5},children:["vs ",t==null?void 0:t.previousPeriod.period]})]})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:2.4,children:e.jsx(p,{children:e.jsxs(g,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Ae,{sx:{mr:1,color:"secondary.main"}}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"API Calls"})]}),e.jsx(s,{variant:"h4",gutterBottom:!0,children:W((t==null?void 0:t.currentPeriod.apiCalls)||0)}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[i((t==null?void 0:t.growth.apiCalls)||0),e.jsxs(s,{variant:"body2",sx:{color:m((t==null?void 0:t.growth.apiCalls)||0),ml:.5},children:[(t==null?void 0:t.growth.apiCalls.toFixed(1))||"0","%"]}),e.jsxs(s,{variant:"body2",color:"textSecondary",sx:{ml:.5},children:["vs ",t==null?void 0:t.previousPeriod.period]})]})]})})})]}),e.jsx(o,{container:!0,spacing:3,children:e.jsx(o,{item:!0,xs:12,children:e.jsxs(p,{children:[e.jsx(ie,{title:"Detailed Usage Statistics",subheader:"Comprehensive breakdown of system usage"}),e.jsx(ee,{}),e.jsx(g,{children:e.jsx(he,{component:re,children:e.jsxs(ue,{children:[e.jsx(me,{children:e.jsxs(N,{children:[e.jsx(l,{children:"Metric"}),e.jsx(l,{align:"right",children:t==null?void 0:t.currentPeriod.period}),e.jsx(l,{align:"right",children:t==null?void 0:t.previousPeriod.period}),e.jsx(l,{align:"right",children:"Change"})]})}),e.jsxs(je,{children:[e.jsxs(N,{children:[e.jsx(l,{component:"th",scope:"row",children:"Total Users"}),e.jsx(l,{align:"right",children:t==null?void 0:t.currentPeriod.users.toLocaleString()}),e.jsx(l,{align:"right",children:t==null?void 0:t.previousPeriod.users.toLocaleString()}),e.jsx(l,{align:"right",children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[i((t==null?void 0:t.growth.users)||0),e.jsxs(s,{variant:"body2",sx:{color:m((t==null?void 0:t.growth.users)||0),ml:.5},children:[t==null?void 0:t.growth.users.toFixed(1),"%"]})]})})]}),e.jsxs(N,{children:[e.jsx(l,{component:"th",scope:"row",children:"Active Users"}),e.jsx(l,{align:"right",children:t==null?void 0:t.currentPeriod.activeUsers.toLocaleString()}),e.jsx(l,{align:"right",children:t==null?void 0:t.previousPeriod.activeUsers.toLocaleString()}),e.jsx(l,{align:"right",children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[i((t==null?void 0:t.growth.activeUsers)||0),e.jsxs(s,{variant:"body2",sx:{color:m((t==null?void 0:t.growth.activeUsers)||0),ml:.5},children:[t==null?void 0:t.growth.activeUsers.toFixed(1),"%"]})]})})]}),e.jsxs(N,{children:[e.jsx(l,{component:"th",scope:"row",children:"Subscriptions"}),e.jsx(l,{align:"right",children:t==null?void 0:t.currentPeriod.subscriptions.toLocaleString()}),e.jsx(l,{align:"right",children:t==null?void 0:t.previousPeriod.subscriptions.toLocaleString()}),e.jsx(l,{align:"right",children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[i((t==null?void 0:t.growth.subscriptions)||0),e.jsxs(s,{variant:"body2",sx:{color:m((t==null?void 0:t.growth.subscriptions)||0),ml:.5},children:[t==null?void 0:t.growth.subscriptions.toFixed(1),"%"]})]})})]}),e.jsxs(N,{children:[e.jsx(l,{component:"th",scope:"row",children:"Active Subscriptions"}),e.jsx(l,{align:"right",children:t==null?void 0:t.currentPeriod.activeSubscriptions.toLocaleString()}),e.jsx(l,{align:"right",children:t==null?void 0:t.previousPeriod.activeSubscriptions.toLocaleString()}),e.jsx(l,{align:"right",children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[i((((t==null?void 0:t.currentPeriod.activeSubscriptions)||0)-((t==null?void 0:t.previousPeriod.activeSubscriptions)||0))/((t==null?void 0:t.previousPeriod.activeSubscriptions)||1)*100),e.jsxs(s,{variant:"body2",sx:{color:m((((t==null?void 0:t.currentPeriod.activeSubscriptions)||0)-((t==null?void 0:t.previousPeriod.activeSubscriptions)||0))/((t==null?void 0:t.previousPeriod.activeSubscriptions)||1)*100),ml:.5},children:[((((t==null?void 0:t.currentPeriod.activeSubscriptions)||0)-((t==null?void 0:t.previousPeriod.activeSubscriptions)||0))/((t==null?void 0:t.previousPeriod.activeSubscriptions)||1)*100).toFixed(1),"%"]})]})})]}),e.jsxs(N,{children:[e.jsx(l,{component:"th",scope:"row",children:"Revenue"}),e.jsx(l,{align:"right",children:I((t==null?void 0:t.currentPeriod.revenue)||0)}),e.jsx(l,{align:"right",children:I((t==null?void 0:t.previousPeriod.revenue)||0)}),e.jsx(l,{align:"right",children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[i((t==null?void 0:t.growth.revenue)||0),e.jsxs(s,{variant:"body2",sx:{color:m((t==null?void 0:t.growth.revenue)||0),ml:.5},children:[t==null?void 0:t.growth.revenue.toFixed(1),"%"]})]})})]}),e.jsxs(N,{children:[e.jsx(l,{component:"th",scope:"row",children:"API Calls"}),e.jsx(l,{align:"right",children:W((t==null?void 0:t.currentPeriod.apiCalls)||0)}),e.jsx(l,{align:"right",children:W((t==null?void 0:t.previousPeriod.apiCalls)||0)}),e.jsx(l,{align:"right",children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[i((t==null?void 0:t.growth.apiCalls)||0),e.jsxs(s,{variant:"body2",sx:{color:m((t==null?void 0:t.growth.apiCalls)||0),ml:.5},children:[t==null?void 0:t.growth.apiCalls.toFixed(1),"%"]})]})})]}),e.jsxs(N,{children:[e.jsx(l,{component:"th",scope:"row",children:"Storage Used (GB)"}),e.jsx(l,{align:"right",children:t==null?void 0:t.currentPeriod.storageUsed.toLocaleString()}),e.jsx(l,{align:"right",children:t==null?void 0:t.previousPeriod.storageUsed.toLocaleString()}),e.jsx(l,{align:"right",children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[i((((t==null?void 0:t.currentPeriod.storageUsed)||0)-((t==null?void 0:t.previousPeriod.storageUsed)||0))/((t==null?void 0:t.previousPeriod.storageUsed)||1)*100),e.jsxs(s,{variant:"body2",sx:{color:m((((t==null?void 0:t.currentPeriod.storageUsed)||0)-((t==null?void 0:t.previousPeriod.storageUsed)||0))/((t==null?void 0:t.previousPeriod.storageUsed)||1)*100),ml:.5},children:[((((t==null?void 0:t.currentPeriod.storageUsed)||0)-((t==null?void 0:t.previousPeriod.storageUsed)||0))/((t==null?void 0:t.previousPeriod.storageUsed)||1)*100).toFixed(1),"%"]})]})})]})]})]})})})]})})})]})},is=()=>{const[w,f]=x.useState(!1),[t,L]=x.useState([{id:"1",name:"Add patient insurance fields",status:"completed",createdAt:new Date(Date.now()-864e5).toISOString(),completedAt:new Date(Date.now()-86e6).toISOString(),duration:120,createdBy:"admin@example.com",description:"Added insurance provider and policy number fields to patient records",version:"1.2.0"},{id:"2",name:"Update medication schema",status:"completed",createdAt:new Date(Date.now()-1728e5).toISOString(),completedAt:new Date(Date.now()-172e6).toISOString(),duration:300,createdBy:"admin@example.com",description:"Modified medication schema to include dosage instructions",version:"1.1.5"},{id:"3",name:"Create audit log collection",status:"failed",createdAt:new Date(Date.now()-2592e5).toISOString(),completedAt:new Date(Date.now()-259e6).toISOString(),duration:45,createdBy:"admin@example.com",description:"Initial creation of audit log collection failed due to permissions",version:"1.1.0"}]),[v,D]=x.useState(null),[C,B]=x.useState(!1),[j,O]=x.useState({name:"",description:"",version:""}),I=le(a=>a.addNotification),W=async()=>{try{f(!0),I({type:"info",title:"Migration Started",message:`Running migration: ${j.name}`}),await new Promise(u=>setTimeout(u,2e3));const a={id:(t.length+1).toString(),name:j.name,status:"completed",createdAt:new Date().toISOString(),completedAt:new Date(Date.now()+5e3).toISOString(),duration:5,createdBy:"current_user@example.com",description:j.description,version:j.version};L([a,...t]),B(!1),O({name:"",description:"",version:""}),I({type:"success",title:"Migration Completed",message:`Successfully completed migration: ${j.name}`})}catch{I({type:"error",title:"Migration Failed",message:`Failed to run migration: ${j.name}`})}finally{f(!1)}},i=async a=>{try{f(!0),I({type:"info",title:"Rollback Started",message:`Rolling back migration: ${a}`}),await new Promise(u=>setTimeout(u,2e3)),L(t.map(u=>u.id===a?{...u,status:"completed"}:u)),I({type:"success",title:"Rollback Completed",message:`Successfully rolled back migration: ${a}`})}catch{I({type:"error",title:"Rollback Failed",message:`Failed to rollback migration: ${a}`})}finally{f(!1)}},m=a=>{switch(a){case"completed":return"success";case"failed":return"error";case"running":return"warning";case"pending":return"info";default:return"default"}},b=a=>{switch(a){case"completed":return e.jsx(_e,{});case"failed":return e.jsx(st,{});case"running":return e.jsx(Me,{});case"pending":return e.jsx(Me,{});default:return e.jsx(tt,{})}};return e.jsxs(n,{children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(at,{sx:{mr:1,color:"primary.main"}}),e.jsx(s,{variant:"h5",component:"h1",children:"Migration Dashboard"})]}),e.jsxs(n,{children:[e.jsx(y,{variant:"contained",startIcon:e.jsx(Ie,{}),onClick:()=>B(!0),sx:{mr:1},children:"Run Migration"}),e.jsx(y,{variant:"outlined",startIcon:e.jsx(ce,{}),onClick:()=>f(!0),children:"Refresh"})]})]}),e.jsxs(o,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"primary.main",gutterBottom:!0,children:t.length}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Total Migrations"})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"success.main",gutterBottom:!0,children:t.filter(a=>a.status==="completed").length}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Successful"})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"error.main",gutterBottom:!0,children:t.filter(a=>a.status==="failed").length}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Failed"})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"info.main",gutterBottom:!0,children:t.filter(a=>a.status==="pending"||a.status==="running").length}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"In Progress"})]})})})]}),e.jsx(o,{container:!0,spacing:3,children:e.jsx(o,{item:!0,xs:12,children:e.jsxs(p,{children:[e.jsx(ie,{title:"Migration History",subheader:"List of all database migrations"}),e.jsx(ee,{}),e.jsx(g,{children:t.length===0?e.jsx(n,{sx:{textAlign:"center",py:4},children:e.jsx(s,{variant:"body1",color:"textSecondary",children:"No migrations found"})}):e.jsx(ye,{children:t.map(a=>e.jsxs(be,{sx:{border:1,borderColor:"divider",borderRadius:1,mb:1,"&:last-child":{mb:0}},children:[e.jsx(n,{sx:{mr:2,mt:.5},children:b(a.status)}),e.jsx(fe,{primary:e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:.5},children:[e.jsx(s,{variant:"subtitle1",sx:{mr:1},children:a.name}),e.jsx(z,{label:a.status,size:"small",color:m(a.status)}),e.jsx(z,{label:`v${a.version}`,size:"small",variant:"outlined",sx:{ml:1}})]}),secondary:e.jsxs(n,{children:[e.jsx(s,{variant:"body2",color:"textSecondary",children:a.description}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",mt:1},children:[e.jsxs(s,{variant:"caption",color:"textSecondary",sx:{mr:2},children:["Created:"," ",new Date(a.createdAt).toLocaleString()]}),a.completedAt&&e.jsxs(s,{variant:"caption",color:"textSecondary",sx:{mr:2},children:["Completed:"," ",new Date(a.completedAt).toLocaleString()]}),a.duration&&e.jsxs(s,{variant:"caption",color:"textSecondary",children:["Duration: ",a.duration,"s"]})]})]})}),e.jsxs(n,{children:[a.status==="failed"&&e.jsx(y,{variant:"outlined",startIcon:e.jsx(et,{}),onClick:()=>i(a.id),size:"small",children:"Rollback"}),e.jsx(y,{variant:"outlined",onClick:()=>D(a),size:"small",sx:{ml:1},children:"Details"})]})]},a.id))})})]})})}),e.jsxs(K,{open:C,onClose:()=>B(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Y,{children:e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Ie,{sx:{mr:1}}),"Run New Migration"]})}),e.jsx(X,{children:e.jsxs(n,{sx:{pt:1},children:[e.jsx(F,{fullWidth:!0,label:"Migration Name",value:j.name,onChange:a=>O({...j,name:a.target.value}),margin:"normal",required:!0}),e.jsx(F,{fullWidth:!0,label:"Description",value:j.description,onChange:a=>O({...j,description:a.target.value}),margin:"normal",multiline:!0,rows:3,required:!0}),e.jsx(F,{fullWidth:!0,label:"Version",value:j.version,onChange:a=>O({...j,version:a.target.value}),margin:"normal",required:!0})]})}),e.jsxs(Z,{children:[e.jsx(y,{onClick:()=>B(!1),children:"Cancel"}),e.jsx(y,{variant:"contained",onClick:W,disabled:w||!j.name||!j.description||!j.version,startIcon:w?e.jsx(oe,{size:20}):e.jsx(Ie,{}),children:"Run Migration"})]})]}),e.jsxs(K,{open:!!v,onClose:()=>D(null),maxWidth:"md",fullWidth:!0,children:[e.jsx(Y,{children:e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[v&&b(v.status),e.jsxs(n,{sx:{ml:1},children:[v==null?void 0:v.name,e.jsx(z,{label:v==null?void 0:v.status,size:"small",color:m((v==null?void 0:v.status)||"default"),sx:{ml:1}})]})]})}),e.jsx(X,{children:v&&e.jsx(n,{sx:{pt:1},children:e.jsxs(o,{container:!0,spacing:3,children:[e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Migration Details"}),e.jsxs(s,{variant:"body2",sx:{mb:1},children:[e.jsx("strong",{children:"ID:"})," ",v.id]}),e.jsxs(s,{variant:"body2",sx:{mb:1},children:[e.jsx("strong",{children:"Name:"})," ",v.name]}),e.jsxs(s,{variant:"body2",sx:{mb:1},children:[e.jsx("strong",{children:"Description:"})," ",v.description]}),e.jsxs(s,{variant:"body2",sx:{mb:1},children:[e.jsx("strong",{children:"Version:"})," ",v.version]}),e.jsxs(s,{variant:"body2",sx:{mb:1},children:[e.jsx("strong",{children:"Created By:"})," ",v.createdBy]})]}),e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Timeline"}),e.jsxs(s,{variant:"body2",sx:{mb:1},children:[e.jsx("strong",{children:"Created:"})," ",new Date(v.createdAt).toLocaleString()]}),v.completedAt&&e.jsxs(s,{variant:"body2",sx:{mb:1},children:[e.jsx("strong",{children:"Completed:"})," ",new Date(v.completedAt).toLocaleString()]}),v.duration&&e.jsxs(s,{variant:"body2",sx:{mb:1},children:[e.jsx("strong",{children:"Duration:"})," ",v.duration," ","seconds"]})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Actions"}),e.jsxs(n,{sx:{display:"flex",gap:1},children:[e.jsx(y,{variant:"outlined",startIcon:e.jsx(Ie,{}),disabled:v.status==="running",children:"Re-run Migration"}),v.status==="failed"&&e.jsx(y,{variant:"outlined",startIcon:e.jsx(et,{}),onClick:()=>i(v.id),children:"Rollback"}),e.jsx(y,{variant:"outlined",children:"View Logs"})]})]})]})})}),e.jsx(Z,{children:e.jsx(y,{onClick:()=>D(null),children:"Close"})})]})]})},as=()=>{const[w,f]=x.useState(!1),[t,L]=x.useState([{id:"1",email:"newuser@example.com",role:"pharmacist",status:"pending",invitedBy:"admin@example.com",invitedAt:new Date(Date.now()-864e5).toISOString(),expiresAt:new Date(Date.now()+6048e5).toISOString(),workspace:"Main Pharmacy"},{id:"2",email:"teamuser@example.com",role:"pharmacy_team",status:"accepted",invitedBy:"admin@example.com",invitedAt:new Date(Date.now()-1728e5).toISOString(),expiresAt:new Date(Date.now()-864e5).toISOString(),workspace:"Main Pharmacy"},{id:"3",email:"expired@example.com",role:"intern_pharmacist",status:"expired",invitedBy:"admin@example.com",invitedAt:new Date(Date.now()-6048e5).toISOString(),expiresAt:new Date(Date.now()-864e5).toISOString(),workspace:"Main Pharmacy"},{id:"4",email:"rejected@example.com",role:"pharmacy_outlet",status:"rejected",invitedBy:"admin@example.com",invitedAt:new Date(Date.now()-2592e5).toISOString(),expiresAt:new Date(Date.now()+3456e5).toISOString(),workspace:"Branch Pharmacy"}]),[v,D]=x.useState(!1),[C,B]=x.useState(""),[j,O]=x.useState("all"),[I,W]=x.useState({email:"",role:"pharmacist",workspace:"Main Pharmacy"}),i=le(h=>h.addNotification),m=async()=>{try{f(!0),i({type:"info",title:"Invitation Sent",message:`Invitation sent to ${I.email}`}),await new Promise(P=>setTimeout(P,1e3));const h={id:(t.length+1).toString(),email:I.email,role:I.role,status:"pending",invitedBy:"current_user@example.com",invitedAt:new Date().toISOString(),expiresAt:new Date(Date.now()+6048e5).toISOString(),workspace:I.workspace};L([h,...t]),D(!1),W({email:"",role:"pharmacist",workspace:"Main Pharmacy"})}catch{i({type:"error",title:"Invitation Failed",message:`Failed to send invitation to ${I.email}`})}finally{f(!1)}},b=async h=>{try{f(!0),i({type:"info",title:"Invitation Revoked",message:`Invitation revoked for ID: ${h}`}),await new Promise(P=>setTimeout(P,1e3)),L(t.map(P=>P.id===h?{...P,status:"rejected"}:P))}catch{i({type:"error",title:"Revoke Failed",message:`Failed to revoke invitation: ${h}`})}finally{f(!1)}},a=async h=>{try{f(!0),i({type:"info",title:"Invitation Resent",message:`Invitation resent for ID: ${h}`}),await new Promise(P=>setTimeout(P,1e3)),L(t.map(P=>P.id===h?{...P,expiresAt:new Date(Date.now()+6048e5).toISOString()}:P))}catch{i({type:"error",title:"Resend Failed",message:`Failed to resend invitation: ${h}`})}finally{f(!1)}},u=h=>{switch(h){case"accepted":return"success";case"rejected":return"error";case"expired":return"warning";case"pending":return"info";default:return"default"}},Q=t.filter(h=>{const P=h.email.toLowerCase().includes(C.toLowerCase())||h.role.toLowerCase().includes(C.toLowerCase()),te=j==="all"||h.status===j;return P&&te});return e.jsxs(n,{children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Oe,{sx:{mr:1,color:"primary.main"}}),e.jsx(s,{variant:"h5",component:"h1",children:"Invitation Management"})]}),e.jsxs(n,{children:[e.jsx(y,{variant:"contained",startIcon:e.jsx(Oe,{}),onClick:()=>D(!0),sx:{mr:1},children:"Invite User"}),e.jsx(y,{variant:"outlined",startIcon:e.jsx(ce,{}),onClick:()=>f(!0),children:"Refresh"})]})]}),e.jsxs(o,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"primary.main",gutterBottom:!0,children:t.length}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Total Invitations"})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"info.main",gutterBottom:!0,children:t.filter(h=>h.status==="pending").length}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Pending"})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"success.main",gutterBottom:!0,children:t.filter(h=>h.status==="accepted").length}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Accepted"})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"warning.main",gutterBottom:!0,children:t.filter(h=>h.status==="expired"||h.status==="rejected").length}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Expired/Rejected"})]})})})]}),e.jsx(p,{sx:{mb:3},children:e.jsx(g,{children:e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(F,{fullWidth:!0,placeholder:"Search by email or role...",value:C,onChange:h=>B(h.target.value),InputProps:{startAdornment:e.jsx($e,{sx:{mr:1,color:"text.secondary"}})}})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsxs(q,{fullWidth:!0,children:[e.jsx(G,{children:"Status Filter"}),e.jsxs(J,{value:j,label:"Status Filter",onChange:h=>O(h.target.value),children:[e.jsx(S,{value:"all",children:"All Statuses"}),e.jsx(S,{value:"pending",children:"Pending"}),e.jsx(S,{value:"accepted",children:"Accepted"}),e.jsx(S,{value:"rejected",children:"Rejected"}),e.jsx(S,{value:"expired",children:"Expired"})]})]})})]})})}),e.jsx(o,{container:!0,spacing:3,children:e.jsx(o,{item:!0,xs:12,children:e.jsxs(p,{children:[e.jsx(ie,{title:"Invitation List",subheader:"Manage all workspace invitations"}),e.jsx(ee,{}),e.jsx(g,{children:Q.length===0?e.jsx(n,{sx:{textAlign:"center",py:4},children:e.jsx(s,{variant:"body1",color:"textSecondary",children:"No invitations found"})}):e.jsx(ye,{children:Q.map(h=>e.jsxs(be,{sx:{border:1,borderColor:"divider",borderRadius:1,mb:1,"&:last-child":{mb:0}},children:[e.jsx(n,{sx:{mr:2,mt:.5},children:e.jsx(Re,{})}),e.jsx(fe,{primary:e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:.5},children:[e.jsx(s,{variant:"subtitle1",sx:{mr:1},children:h.email}),e.jsx(z,{label:h.status,size:"small",color:u(h.status)}),e.jsx(z,{label:h.role,size:"small",variant:"outlined",sx:{ml:1}})]}),secondary:e.jsxs(n,{children:[e.jsxs(s,{variant:"body2",color:"textSecondary",children:["Invited by ",h.invitedBy," to"," ",h.workspace]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",mt:1},children:[e.jsxs(s,{variant:"caption",color:"textSecondary",sx:{mr:2},children:["Invited:"," ",new Date(h.invitedAt).toLocaleDateString()]}),e.jsxs(s,{variant:"caption",color:"textSecondary",children:["Expires:"," ",new Date(h.expiresAt).toLocaleDateString()]})]})]})}),e.jsxs(n,{children:[h.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"outlined",size:"small",onClick:()=>a(h.id),sx:{mr:1},children:"Resend"}),e.jsx(y,{variant:"outlined",color:"error",size:"small",onClick:()=>b(h.id),children:"Revoke"})]}),h.status==="expired"&&e.jsx(y,{variant:"outlined",size:"small",onClick:()=>a(h.id),children:"Resend"})]})]},h.id))})})]})})}),e.jsxs(K,{open:v,onClose:()=>D(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Y,{children:e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Oe,{sx:{mr:1}}),"Invite New User"]})}),e.jsx(X,{children:e.jsxs(n,{sx:{pt:1},children:[e.jsx(F,{fullWidth:!0,label:"Email Address",type:"email",value:I.email,onChange:h=>W({...I,email:h.target.value}),margin:"normal",required:!0}),e.jsxs(q,{fullWidth:!0,margin:"normal",children:[e.jsx(G,{children:"Role"}),e.jsxs(J,{value:I.role,label:"Role",onChange:h=>W({...I,role:h.target.value}),children:[e.jsx(S,{value:"pharmacist",children:"Pharmacist"}),e.jsx(S,{value:"pharmacy_team",children:"Pharmacy Team"}),e.jsx(S,{value:"pharmacy_outlet",children:"Pharmacy Outlet"}),e.jsx(S,{value:"intern_pharmacist",children:"Intern Pharmacist"})]})]}),e.jsxs(q,{fullWidth:!0,margin:"normal",children:[e.jsx(G,{children:"Workspace"}),e.jsxs(J,{value:I.workspace,label:"Workspace",onChange:h=>W({...I,workspace:h.target.value}),children:[e.jsx(S,{value:"Main Pharmacy",children:"Main Pharmacy"}),e.jsx(S,{value:"Branch Pharmacy",children:"Branch Pharmacy"}),e.jsx(S,{value:"Mobile Unit",children:"Mobile Unit"})]})]})]})}),e.jsxs(Z,{children:[e.jsx(y,{onClick:()=>D(!1),children:"Cancel"}),e.jsx(y,{variant:"contained",onClick:m,disabled:w||!I.email||!I.email.includes("@"),startIcon:w?e.jsx(oe,{size:20}):e.jsx(Re,{}),children:"Send Invitation"})]})]})]})},ls=()=>{const[w,f]=x.useState(!1),[t,L]=x.useState([{id:"1",name:"Main Pharmacy",address:"123 Main Street",city:"Lagos",state:"Lagos",country:"Nigeria",phone:"+234 123 456 7890",email:"main@pharmacare.com",isActive:!0,createdAt:new Date(Date.now()-864e5).toISOString(),updatedAt:new Date(Date.now()-864e5).toISOString(),manager:"John Pharmacist",capacity:50},{id:"2",name:"Branch Pharmacy",address:"456 Branch Road",city:"Abuja",state:"FCT",country:"Nigeria",phone:"+234 987 654 3210",email:"branch@pharmacare.com",isActive:!0,createdAt:new Date(Date.now()-1728e5).toISOString(),updatedAt:new Date(Date.now()-864e5).toISOString(),manager:"Jane Pharmacist",capacity:30},{id:"3",name:"Mobile Unit",address:"Various Locations",city:"Multiple",state:"Multiple",country:"Nigeria",phone:"+234 555 555 5555",email:"mobile@pharmacare.com",isActive:!1,createdAt:new Date(Date.now()-2592e5).toISOString(),updatedAt:new Date(Date.now()-1728e5).toISOString()}]),[v,D]=x.useState(!1),[C,B]=x.useState(null),[j,O]=x.useState(""),[I,W]=x.useState("all"),[i,m]=x.useState({name:"",address:"",city:"",state:"",country:"Nigeria",phone:"",email:"",isActive:!0}),b=le(c=>c.addNotification),a=async()=>{try{f(!0);const c=C?"updated":"created";if(b({type:"info",title:`Location ${c}`,message:`Location ${i.name} has been ${c}`}),await new Promise(T=>setTimeout(T,1e3)),C)L(t.map(T=>T.id===C.id?{...T,...i,updatedAt:new Date().toISOString()}:T));else{const T={id:(t.length+1).toString(),...i,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};L([T,...t])}D(!1),B(null),m({name:"",address:"",city:"",state:"",country:"Nigeria",phone:"",email:"",isActive:!0})}catch{b({type:"error",title:"Operation Failed",message:`Failed to save location: ${i.name}`})}finally{f(!1)}},u=async c=>{try{f(!0);const T=t.find(E=>E.id===c);b({type:"info",title:"Location Deleted",message:`Location ${T==null?void 0:T.name} has been deleted`}),await new Promise(E=>setTimeout(E,1e3)),L(t.filter(E=>E.id!==c))}catch{b({type:"error",title:"Delete Failed",message:"Failed to delete location"})}finally{f(!1)}},Q=async c=>{try{f(!0);const T=t.find(E=>E.id===c);b({type:"info",title:"Status Updated",message:`Location ${T==null?void 0:T.name} status updated`}),await new Promise(E=>setTimeout(E,500)),L(t.map(E=>E.id===c?{...E,isActive:!E.isActive,updatedAt:new Date().toISOString()}:E))}catch{b({type:"error",title:"Status Update Failed",message:"Failed to update location status"})}finally{f(!1)}},h=c=>{B(c),m({name:c.name,address:c.address,city:c.city,state:c.state,country:c.country,phone:c.phone,email:c.email,isActive:c.isActive}),D(!0)},P=()=>{B(null),m({name:"",address:"",city:"",state:"",country:"Nigeria",phone:"",email:"",isActive:!0}),D(!0)},te=t.filter(c=>{const T=c.name.toLowerCase().includes(j.toLowerCase())||c.city.toLowerCase().includes(j.toLowerCase())||c.state.toLowerCase().includes(j.toLowerCase()),E=I==="all"||I==="active"&&c.isActive||I==="inactive"&&!c.isActive;return T&&E});return e.jsxs(n,{children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ke,{sx:{mr:1,color:"primary.main"}}),e.jsx(s,{variant:"h5",component:"h1",children:"Location Management"})]}),e.jsxs(n,{children:[e.jsx(y,{variant:"contained",startIcon:e.jsx(Le,{}),onClick:P,sx:{mr:1},children:"Add Location"}),e.jsx(y,{variant:"outlined",startIcon:e.jsx(ce,{}),onClick:()=>f(!0),children:"Refresh"})]})]}),e.jsxs(o,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"primary.main",gutterBottom:!0,children:t.length}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Total Locations"})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"success.main",gutterBottom:!0,children:t.filter(c=>c.isActive).length}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Active"})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"warning.main",gutterBottom:!0,children:t.filter(c=>!c.isActive).length}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Inactive"})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"info.main",gutterBottom:!0,children:t.filter(c=>c.manager).length}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Managed Locations"})]})})})]}),e.jsx(p,{sx:{mb:3},children:e.jsx(g,{children:e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(F,{fullWidth:!0,placeholder:"Search by name, city, or state...",value:j,onChange:c=>O(c.target.value),InputProps:{startAdornment:e.jsx($e,{sx:{mr:1,color:"text.secondary"}})}})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsxs(q,{fullWidth:!0,children:[e.jsx(G,{children:"Status Filter"}),e.jsxs(J,{value:I,label:"Status Filter",onChange:c=>W(c.target.value),children:[e.jsx(S,{value:"all",children:"All Locations"}),e.jsx(S,{value:"active",children:"Active"}),e.jsx(S,{value:"inactive",children:"Inactive"})]})]})})]})})}),e.jsx(o,{container:!0,spacing:3,children:e.jsx(o,{item:!0,xs:12,children:e.jsxs(p,{children:[e.jsx(ie,{title:"Location List",subheader:"Manage all pharmacy locations"}),e.jsx(ee,{}),e.jsx(g,{children:te.length===0?e.jsx(n,{sx:{textAlign:"center",py:4},children:e.jsx(s,{variant:"body1",color:"textSecondary",children:"No locations found"})}):e.jsx(ye,{children:te.map(c=>e.jsxs(be,{sx:{border:1,borderColor:"divider",borderRadius:1,mb:1,"&:last-child":{mb:0}},children:[e.jsx(n,{sx:{mr:2,mt:.5},children:e.jsx(ke,{})}),e.jsx(fe,{primary:e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:.5},children:[e.jsx(s,{variant:"subtitle1",sx:{mr:1},children:c.name}),e.jsx(z,{label:c.isActive?"Active":"Inactive",size:"small",color:c.isActive?"success":"default"}),c.manager&&e.jsx(z,{label:`Manager: ${c.manager}`,size:"small",variant:"outlined",sx:{ml:1}})]}),secondary:e.jsxs(n,{children:[e.jsxs(s,{variant:"body2",color:"textSecondary",sx:{mb:1},children:[c.address,", ",c.city,","," ",c.state,", ",c.country]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsxs(s,{variant:"caption",color:"textSecondary",sx:{mr:2,display:"flex",alignItems:"center"},children:[e.jsx(At,{sx:{fontSize:"0.8rem",mr:.5}}),c.phone]}),e.jsxs(s,{variant:"caption",color:"textSecondary",sx:{mr:2,display:"flex",alignItems:"center"},children:[e.jsx(Re,{sx:{fontSize:"0.8rem",mr:.5}}),c.email]}),e.jsxs(s,{variant:"caption",color:"textSecondary",children:["Updated:"," ",new Date(c.updatedAt).toLocaleDateString()]})]})]})}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ne,{control:e.jsx(Be,{checked:c.isActive,onChange:()=>Q(c.id),disabled:w}),label:c.isActive?"Active":"Inactive",sx:{mr:1}}),e.jsx(M,{onClick:()=>h(c),disabled:w,children:e.jsx(Pe,{})}),e.jsx(M,{onClick:()=>u(c.id),disabled:w,color:"error",children:e.jsx(it,{})})]})]},c.id))})})]})})}),e.jsxs(K,{open:v,onClose:()=>D(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Y,{children:e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ke,{sx:{mr:1}}),C?"Edit Location":"Add New Location"]})}),e.jsx(X,{children:e.jsxs(n,{sx:{pt:1},children:[e.jsx(F,{fullWidth:!0,label:"Location Name",value:i.name,onChange:c=>m({...i,name:c.target.value}),margin:"normal",required:!0}),e.jsx(F,{fullWidth:!0,label:"Address",value:i.address,onChange:c=>m({...i,address:c.target.value}),margin:"normal",required:!0}),e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(F,{fullWidth:!0,label:"City",value:i.city,onChange:c=>m({...i,city:c.target.value}),margin:"normal",required:!0})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(F,{fullWidth:!0,label:"State",value:i.state,onChange:c=>m({...i,state:c.target.value}),margin:"normal",required:!0})})]}),e.jsx(F,{fullWidth:!0,label:"Country",value:i.country,onChange:c=>m({...i,country:c.target.value}),margin:"normal",required:!0}),e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(F,{fullWidth:!0,label:"Phone",value:i.phone,onChange:c=>m({...i,phone:c.target.value}),margin:"normal"})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(F,{fullWidth:!0,label:"Email",type:"email",value:i.email,onChange:c=>m({...i,email:c.target.value}),margin:"normal"})})]}),e.jsx(ne,{control:e.jsx(Be,{checked:i.isActive,onChange:c=>m({...i,isActive:c.target.checked})}),label:"Active Location",sx:{mt:1}})]})}),e.jsxs(Z,{children:[e.jsx(y,{onClick:()=>D(!1),children:"Cancel"}),e.jsx(y,{variant:"contained",onClick:a,disabled:w||!i.name||!i.address||!i.city||!i.state,startIcon:w?e.jsx(oe,{size:20}):C?e.jsx(Pe,{}):e.jsx(Le,{}),children:C?"Update Location":"Add Location"})]})]})]})},os=()=>{const[w,f]=x.useState(!1),[t,L]=x.useState([{id:"1",name:"Payment Notifications",url:"https://api.example.com/webhooks/payments",events:["payment.success","payment.failed","subscription.renewed"],status:"active",createdAt:new Date(Date.now()-864e5).toISOString(),updatedAt:new Date(Date.now()-36e5).toISOString(),lastDelivery:new Date(Date.now()-36e5).toISOString(),lastDeliveryStatus:"success",secret:"whsec_*******************",description:"Handles payment and subscription events from our payment processor"},{id:"2",name:"User Management",url:"https://internal.example.com/webhooks/users",events:["user.created","user.updated","user.deleted"],status:"active",createdAt:new Date(Date.now()-1728e5).toISOString(),updatedAt:new Date(Date.now()-864e5).toISOString(),lastDelivery:new Date(Date.now()-72e5).toISOString(),lastDeliveryStatus:"success",secret:"whsec_*******************",description:"Syncs user data with our internal systems"},{id:"3",name:"Audit Logs",url:"https://logs.example.com/webhooks/audit",events:["audit.log"],status:"error",createdAt:new Date(Date.now()-2592e5).toISOString(),updatedAt:new Date(Date.now()-1e6).toISOString(),lastDelivery:new Date(Date.now()-1e6).toISOString(),lastDeliveryStatus:"failed",secret:"whsec_*******************",description:"Sends audit logs to our centralized logging system"}]),[v,D]=x.useState(!1),[C,B]=x.useState(null),[j,O]=x.useState(""),[I,W]=x.useState("all"),[i,m]=x.useState({name:"",url:"",events:[],status:"active",secret:"",description:""}),[b,a]=x.useState(null),u=le(d=>d.addNotification),Q=async()=>{try{f(!0);const d=C?"updated":"created";if(u({type:"info",title:`Webhook ${d}`,message:`Webhook ${i.name} has been ${d}`}),await new Promise(R=>setTimeout(R,1e3)),C)L(t.map(R=>R.id===C.id?{...R,...i,updatedAt:new Date().toISOString()}:R));else{const R={id:(t.length+1).toString(),...i,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};L([R,...t])}D(!1),B(null),m({name:"",url:"",events:[],status:"active",secret:"",description:""})}catch{u({type:"error",title:"Operation Failed",message:`Failed to save webhook: ${i.name}`})}finally{f(!1)}},h=async d=>{try{f(!0);const R=t.find(A=>A.id===d);u({type:"info",title:"Webhook Deleted",message:`Webhook ${R==null?void 0:R.name} has been deleted`}),await new Promise(A=>setTimeout(A,1e3)),L(t.filter(A=>A.id!==d))}catch{u({type:"error",title:"Delete Failed",message:"Failed to delete webhook"})}finally{f(!1)}},P=async d=>{try{f(!0);const R=t.find(A=>A.id===d);u({type:"info",title:"Status Updated",message:`Webhook ${R==null?void 0:R.name} status updated`}),await new Promise(A=>setTimeout(A,500)),L(t.map(A=>A.id===d?{...A,status:A.status==="active"?"inactive":"active",updatedAt:new Date().toISOString()}:A))}catch{u({type:"error",title:"Status Update Failed",message:"Failed to update webhook status"})}finally{f(!1)}},te=async d=>{try{f(!0);const R=t.find(A=>A.id===d);u({type:"info",title:"Test Sent",message:`Test event sent to webhook ${R==null?void 0:R.name}`}),await new Promise(A=>setTimeout(A,1e3)),L(t.map(A=>A.id===d?{...A,lastDelivery:new Date().toISOString(),lastDeliveryStatus:Math.random()>.2?"success":"failed"}:A))}catch{u({type:"error",title:"Test Failed",message:"Failed to send test event"})}finally{f(!1)}},c=(d,R)=>{navigator.clipboard.writeText(d),a(R),setTimeout(()=>a(null),2e3),u({type:"success",title:"Copied",message:"Webhook secret copied to clipboard"})},T=d=>{B(d),m({name:d.name,url:d.url,events:[...d.events],status:d.status,secret:d.secret||"",description:d.description||""}),D(!0)},E=()=>{B(null),m({name:"",url:"",events:[],status:"active",secret:"",description:""}),D(!0)},se=d=>{switch(d){case"active":return"success";case"inactive":return"default";case"error":return"error";default:return"default"}},Se=d=>{switch(d){case"success":return"success";case"failed":return"error";default:return"default"}},we=t.filter(d=>{const R=d.name.toLowerCase().includes(j.toLowerCase())||d.url.toLowerCase().includes(j.toLowerCase())||d.events.some(U=>U.toLowerCase().includes(j.toLowerCase())),A=I==="all"||d.status===I;return R&&A});return e.jsxs(n,{children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ve,{sx:{mr:1,color:"primary.main"}}),e.jsx(s,{variant:"h5",component:"h1",children:"Webhook Management"})]}),e.jsxs(n,{children:[e.jsx(y,{variant:"contained",startIcon:e.jsx(Le,{}),onClick:E,sx:{mr:1},children:"Add Webhook"}),e.jsx(y,{variant:"outlined",startIcon:e.jsx(ce,{}),onClick:()=>f(!0),children:"Refresh"})]})]}),e.jsxs(o,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"primary.main",gutterBottom:!0,children:t.length}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Total Webhooks"})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"success.main",gutterBottom:!0,children:t.filter(d=>d.status==="active").length}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Active"})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"error.main",gutterBottom:!0,children:t.filter(d=>d.status==="error").length}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"With Errors"})]})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h4",color:"info.main",gutterBottom:!0,children:t.filter(d=>d.lastDeliveryStatus==="success").length}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Recent Success"})]})})})]}),e.jsx(p,{sx:{mb:3},children:e.jsx(g,{children:e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(F,{fullWidth:!0,placeholder:"Search by name, URL, or events...",value:j,onChange:d=>O(d.target.value),InputProps:{startAdornment:e.jsx($e,{sx:{mr:1,color:"text.secondary"}})}})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsxs(q,{fullWidth:!0,children:[e.jsx(G,{children:"Status Filter"}),e.jsxs(J,{value:I,label:"Status Filter",onChange:d=>W(d.target.value),children:[e.jsx(S,{value:"all",children:"All Webhooks"}),e.jsx(S,{value:"active",children:"Active"}),e.jsx(S,{value:"inactive",children:"Inactive"}),e.jsx(S,{value:"error",children:"Error"})]})]})})]})})}),e.jsx(o,{container:!0,spacing:3,children:e.jsx(o,{item:!0,xs:12,children:e.jsxs(p,{children:[e.jsx(ie,{title:"Webhook Endpoints",subheader:"Manage all webhook endpoints and their configurations"}),e.jsx(ee,{}),e.jsx(g,{children:we.length===0?e.jsx(n,{sx:{textAlign:"center",py:4},children:e.jsx(s,{variant:"body1",color:"textSecondary",children:"No webhooks found"})}):e.jsx(ye,{children:we.map(d=>e.jsxs(be,{sx:{border:1,borderColor:"divider",borderRadius:1,mb:1,"&:last-child":{mb:0}},children:[e.jsx(n,{sx:{mr:2,mt:.5},children:e.jsx(ve,{})}),e.jsx(fe,{primary:e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:.5},children:[e.jsx(s,{variant:"subtitle1",sx:{mr:1},children:d.name}),e.jsx(z,{label:d.status,size:"small",color:se(d.status)}),d.lastDeliveryStatus&&e.jsx(z,{label:d.lastDeliveryStatus,size:"small",color:Se(d.lastDeliveryStatus),variant:"outlined",sx:{ml:1}})]}),secondary:e.jsxs(n,{children:[e.jsx(s,{variant:"body2",color:"textSecondary",sx:{mb:1},children:d.url}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[e.jsxs(s,{variant:"caption",color:"textSecondary",sx:{mr:2},children:["Events: ",d.events.join(", ")]}),e.jsxs(s,{variant:"caption",color:"textSecondary",sx:{mr:2},children:["Created:"," ",new Date(d.createdAt).toLocaleDateString()]}),d.lastDelivery&&e.jsxs(s,{variant:"caption",color:"textSecondary",children:["Last delivery:"," ",new Date(d.lastDelivery).toLocaleDateString()]})]})]})}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(xe,{title:"Test Webhook",children:e.jsx(M,{onClick:()=>te(d.id),disabled:w,sx:{mr:1},children:e.jsx(ve,{})})}),e.jsx(xe,{title:"View Details",children:e.jsx(M,{onClick:()=>T(d),disabled:w,sx:{mr:1},children:e.jsx(Dt,{})})}),e.jsx(ne,{control:e.jsx(Be,{checked:d.status==="active",onChange:()=>P(d.id),disabled:w}),label:d.status==="active"?"Active":"Inactive",sx:{mr:1}}),e.jsx(M,{onClick:()=>h(d.id),disabled:w,color:"error",children:e.jsx(it,{})})]})]},d.id))})})]})})}),e.jsxs(K,{open:v,onClose:()=>D(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Y,{children:e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ve,{sx:{mr:1}}),C?"Edit Webhook":"Add New Webhook"]})}),e.jsx(X,{children:e.jsxs(n,{sx:{pt:1},children:[e.jsx(F,{fullWidth:!0,label:"Webhook Name",value:i.name,onChange:d=>m({...i,name:d.target.value}),margin:"normal",required:!0}),e.jsx(F,{fullWidth:!0,label:"Endpoint URL",value:i.url,onChange:d=>m({...i,url:d.target.value}),margin:"normal",required:!0,helperText:"The URL where webhook events will be sent"}),e.jsx(F,{fullWidth:!0,label:"Description",value:i.description,onChange:d=>m({...i,description:d.target.value}),margin:"normal",multiline:!0,rows:2}),e.jsx(F,{fullWidth:!0,label:"Webhook Secret",value:i.secret,onChange:d=>m({...i,secret:d.target.value}),margin:"normal",type:"password",helperText:"Used to verify webhook authenticity"}),C&&i.secret&&e.jsx(n,{sx:{display:"flex",alignItems:"center",mt:1},children:e.jsx(y,{startIcon:b===C.id?e.jsx(Rt,{}):e.jsx(es,{}),onClick:()=>c(i.secret,C.id),size:"small",children:b===C.id?"Copied!":"Copy Secret"})}),e.jsxs(q,{fullWidth:!0,margin:"normal",children:[e.jsx(G,{children:"Status"}),e.jsxs(J,{value:i.status,label:"Status",onChange:d=>m({...i,status:d.target.value}),children:[e.jsx(S,{value:"active",children:"Active"}),e.jsx(S,{value:"inactive",children:"Inactive"})]})]})]})}),e.jsxs(Z,{children:[e.jsx(y,{onClick:()=>D(!1),children:"Cancel"}),e.jsx(y,{variant:"contained",onClick:Q,disabled:w||!i.name||!i.url,startIcon:w?e.jsx(oe,{size:20}):C?e.jsx(Pe,{}):e.jsx(Le,{}),children:C?"Update Webhook":"Add Webhook"})]})]})]})},cs=()=>{const[w,f]=x.useState(!0),[t,L]=x.useState(null),[v,D]=x.useState("month"),[C,B]=x.useState(0),[j,O]=x.useState(null),I=le(a=>a.addNotification),W=async()=>{try{f(!0),O(null),L({revenueTrend:[{date:"2023-05-01",amount:12500,subscriptions:85,churnRate:2.5},{date:"2023-06-01",amount:14200,subscriptions:92,churnRate:2.1},{date:"2023-07-01",amount:16800,subscriptions:105,churnRate:1.8},{date:"2023-08-01",amount:18900,subscriptions:118,churnRate:1.5},{date:"2023-09-01",amount:21500,subscriptions:132,churnRate:1.2},{date:"2023-10-01",amount:24800,subscriptions:148,churnRate:1}],subscriptionDistribution:[{tier:"Free Trial",count:120,percentage:15,revenue:0,mrr:0,churnRate:85},{tier:"Basic",count:280,percentage:35,revenue:28e4,mrr:28e3,churnRate:8},{tier:"Pro",count:250,percentage:31,revenue:375e3,mrr:37500,churnRate:5},{tier:"Enterprise",count:150,percentage:19,revenue:45e4,mrr:45e3,churnRate:2}],featureUsage:[{feature:"Patient Management",usage:95,limit:100,percentage:95},{feature:"Medication Tracking",usage:87,limit:100,percentage:87},{feature:"Clinical Notes",usage:72,limit:100,percentage:72},{feature:"ADR Module",usage:45,limit:100,percentage:45},{feature:"Reports Export",usage:68,limit:100,percentage:68}],keyMetrics:{mrr:110500,arr:1326e3,churnRate:4.1,ltv:26800,arpu:138}})}catch{O("Failed to load analytics data"),I({type:"error",title:"Error",message:"Failed to load advanced subscription analytics"})}finally{f(!1)}};x.useEffect(()=>{W()},[v]);const i=a=>new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",minimumFractionDigits:0,maximumFractionDigits:0}).format(a),m=(a,u)=>a>u?e.jsx(ze,{sx:{color:"success.main",fontSize:"1rem"}}):a<u?e.jsx(nt,{sx:{color:"error.main",fontSize:"1rem"}}):null,b=(a,u)=>a>u?"success.main":a<u?"error.main":"text.primary";return w?e.jsx(n,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:e.jsx(oe,{})}):j?e.jsx(Te,{severity:"error",sx:{m:2},children:j}):e.jsxs(n,{children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Ae,{sx:{mr:1,color:"primary.main"}}),e.jsx(s,{variant:"h5",component:"h1",children:"Advanced Subscription Analytics"})]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(q,{size:"small",sx:{minWidth:120},children:[e.jsx(G,{children:"Period"}),e.jsxs(J,{value:v,label:"Period",onChange:a=>D(a.target.value),children:[e.jsx(S,{value:"week",children:"This Week"}),e.jsx(S,{value:"month",children:"This Month"}),e.jsx(S,{value:"quarter",children:"This Quarter"}),e.jsx(S,{value:"year",children:"This Year"})]})]}),e.jsx(y,{variant:"outlined",startIcon:e.jsx(ce,{}),onClick:W,children:"Refresh"})]})]}),e.jsxs(o,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(o,{size:{xs:12,sm:6,md:2.4},children:e.jsx(p,{children:e.jsxs(g,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Ze,{sx:{mr:1,color:"primary.main"}}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"MRR"})]}),e.jsx(s,{variant:"h4",gutterBottom:!0,children:i((t==null?void 0:t.keyMetrics.mrr)||0)}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[m((t==null?void 0:t.keyMetrics.mrr)||0,((t==null?void 0:t.keyMetrics.mrr)||0)*.95),e.jsx(s,{variant:"body2",sx:{color:b((t==null?void 0:t.keyMetrics.mrr)||0,((t==null?void 0:t.keyMetrics.mrr)||0)*.95),ml:.5},children:"+5.2%"}),e.jsx(s,{variant:"body2",color:"textSecondary",sx:{ml:.5},children:"vs last period"})]})]})})}),e.jsx(o,{size:{xs:12,sm:6,md:2.4},children:e.jsx(p,{children:e.jsxs(g,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Ze,{sx:{mr:1,color:"success.main"}}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"ARR"})]}),e.jsx(s,{variant:"h4",gutterBottom:!0,children:i((t==null?void 0:t.keyMetrics.arr)||0)}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[m((t==null?void 0:t.keyMetrics.arr)||0,((t==null?void 0:t.keyMetrics.arr)||0)*.92),e.jsx(s,{variant:"body2",sx:{color:b((t==null?void 0:t.keyMetrics.arr)||0,((t==null?void 0:t.keyMetrics.arr)||0)*.92),ml:.5},children:"+8.7%"}),e.jsx(s,{variant:"body2",color:"textSecondary",sx:{ml:.5},children:"vs last period"})]})]})})}),e.jsx(o,{size:{xs:12,sm:6,md:2.4},children:e.jsx(p,{children:e.jsxs(g,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(De,{sx:{mr:1,color:"info.main"}}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Churn Rate"})]}),e.jsxs(s,{variant:"h4",gutterBottom:!0,children:[((t==null?void 0:t.keyMetrics.churnRate)||0).toFixed(1),"%"]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[m((t==null?void 0:t.keyMetrics.churnRate)||0,((t==null?void 0:t.keyMetrics.churnRate)||0)*1.2),e.jsx(s,{variant:"body2",sx:{color:b(((t==null?void 0:t.keyMetrics.churnRate)||0)*1.2,(t==null?void 0:t.keyMetrics.churnRate)||0),ml:.5},children:"-17.1%"}),e.jsx(s,{variant:"body2",color:"textSecondary",sx:{ml:.5},children:"improvement"})]})]})})}),e.jsx(o,{size:{xs:12,sm:6,md:2.4},children:e.jsx(p,{children:e.jsxs(g,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Ne,{sx:{mr:1,color:"warning.main"}}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"LTV"})]}),e.jsx(s,{variant:"h4",gutterBottom:!0,children:i((t==null?void 0:t.keyMetrics.ltv)||0)}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[m((t==null?void 0:t.keyMetrics.ltv)||0,((t==null?void 0:t.keyMetrics.ltv)||0)*.9),e.jsx(s,{variant:"body2",sx:{color:b((t==null?void 0:t.keyMetrics.ltv)||0,((t==null?void 0:t.keyMetrics.ltv)||0)*.9),ml:.5},children:"+11.1%"}),e.jsx(s,{variant:"body2",color:"textSecondary",sx:{ml:.5},children:"vs last period"})]})]})})}),e.jsx(o,{size:{xs:12,sm:6,md:2.4},children:e.jsx(p,{children:e.jsxs(g,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Ye,{sx:{mr:1,color:"secondary.main"}}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"ARPU"})]}),e.jsx(s,{variant:"h4",gutterBottom:!0,children:i((t==null?void 0:t.keyMetrics.arpu)||0)}),e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[m((t==null?void 0:t.keyMetrics.arpu)||0,((t==null?void 0:t.keyMetrics.arpu)||0)*.95),e.jsx(s,{variant:"body2",sx:{color:b((t==null?void 0:t.keyMetrics.arpu)||0,((t==null?void 0:t.keyMetrics.arpu)||0)*.95),ml:.5},children:"+5.3%"}),e.jsx(s,{variant:"body2",color:"textSecondary",sx:{ml:.5},children:"vs last period"})]})]})})})]}),e.jsxs(p,{children:[e.jsxs(rt,{value:C,onChange:(a,u)=>B(u),variant:"scrollable",scrollButtons:"auto",children:[e.jsx(V,{icon:e.jsx(Ye,{}),label:"Revenue Trend"}),e.jsx(V,{icon:e.jsx(ts,{}),label:"Subscription Distribution"}),e.jsx(V,{icon:e.jsx(Ne,{}),label:"Feature Usage"})]}),e.jsx(ee,{}),e.jsxs(g,{children:[C===0&&e.jsxs(n,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Revenue Trend"}),e.jsx(he,{component:re,children:e.jsxs(ue,{children:[e.jsx(me,{children:e.jsxs(N,{children:[e.jsx(l,{children:"Date"}),e.jsx(l,{align:"right",children:"Revenue"}),e.jsx(l,{align:"right",children:"Subscriptions"}),e.jsx(l,{align:"right",children:"Churn Rate"})]})}),e.jsx(je,{children:t==null?void 0:t.revenueTrend.map((a,u)=>e.jsxs(N,{children:[e.jsx(l,{component:"th",scope:"row",children:new Date(a.date).toLocaleDateString("en-US",{month:"short",year:"numeric"})}),e.jsx(l,{align:"right",children:i(a.amount)}),e.jsx(l,{align:"right",children:a.subscriptions}),e.jsxs(l,{align:"right",children:[a.churnRate,"%"]})]},u))})]})})]}),C===1&&e.jsxs(n,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Subscription Distribution"}),e.jsx(he,{component:re,children:e.jsxs(ue,{children:[e.jsx(me,{children:e.jsxs(N,{children:[e.jsx(l,{children:"Plan Tier"}),e.jsx(l,{align:"right",children:"Subscriptions"}),e.jsx(l,{align:"right",children:"Percentage"}),e.jsx(l,{align:"right",children:"Revenue"}),e.jsx(l,{align:"right",children:"MRR"}),e.jsx(l,{align:"right",children:"Churn Rate"})]})}),e.jsx(je,{children:t==null?void 0:t.subscriptionDistribution.map((a,u)=>e.jsxs(N,{children:[e.jsx(l,{component:"th",scope:"row",children:e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(s,{variant:"body2",children:a.tier}),a.tier==="Enterprise"&&e.jsx(z,{label:"Premium",size:"small",color:"primary",variant:"outlined",sx:{ml:1}})]})}),e.jsx(l,{align:"right",children:a.count}),e.jsxs(l,{align:"right",children:[a.percentage,"%"]}),e.jsx(l,{align:"right",children:i(a.revenue)}),e.jsx(l,{align:"right",children:i(a.mrr)}),e.jsxs(l,{align:"right",children:[a.churnRate,"%"]})]},u))})]})}),e.jsxs(n,{sx:{mt:3},children:[e.jsx(s,{variant:"subtitle1",gutterBottom:!0,children:"Distribution by Plan Tier"}),t==null?void 0:t.subscriptionDistribution.map((a,u)=>e.jsxs(n,{sx:{mb:2},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",mb:.5},children:[e.jsx(s,{variant:"body2",children:a.tier}),e.jsxs(s,{variant:"body2",children:[a.percentage,"%"]})]}),e.jsx(Xe,{variant:"determinate",value:a.percentage,sx:{height:8,borderRadius:4,backgroundColor:"grey.200","& .MuiLinearProgress-bar":{backgroundColor:u===0?"primary.main":u===1?"secondary.main":u===2?"success.main":"warning.main"}}})]},u))]})]}),C===2&&e.jsxs(n,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Feature Usage"}),e.jsx(he,{component:re,children:e.jsxs(ue,{children:[e.jsx(me,{children:e.jsxs(N,{children:[e.jsx(l,{children:"Feature"}),e.jsx(l,{align:"right",children:"Usage"}),e.jsx(l,{align:"right",children:"Limit"}),e.jsx(l,{align:"right",children:"Percentage"})]})}),e.jsx(je,{children:t==null?void 0:t.featureUsage.map((a,u)=>e.jsxs(N,{children:[e.jsx(l,{component:"th",scope:"row",children:a.feature}),e.jsx(l,{align:"right",children:a.usage}),e.jsx(l,{align:"right",children:a.limit||"Unlimited"}),e.jsx(l,{align:"right",children:e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(n,{sx:{width:"100%",mr:1},children:e.jsx(Xe,{variant:"determinate",value:a.percentage,sx:{height:6,borderRadius:3,backgroundColor:"grey.200","& .MuiLinearProgress-bar":{backgroundColor:a.percentage>80?"error.main":a.percentage>60?"warning.main":"success.main"}}})}),e.jsxs(s,{variant:"body2",sx:{minWidth:40},children:[a.percentage,"%"]})]})})]},u))})]})}),e.jsxs(n,{sx:{mt:3},children:[e.jsx(s,{variant:"subtitle1",gutterBottom:!0,children:"Usage Insights"}),e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{size:{xs:12,md:6},children:e.jsxs(re,{sx:{p:2,height:"100%"},children:[e.jsx(s,{variant:"subtitle2",gutterBottom:!0,children:"High Usage Features"}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"Patient Management and Medication Tracking are the most utilized features, indicating strong core adoption."})]})}),e.jsx(o,{size:{xs:12,md:6},children:e.jsxs(re,{sx:{p:2,height:"100%"},children:[e.jsx(s,{variant:"subtitle2",gutterBottom:!0,children:"Underutilized Features"}),e.jsx(s,{variant:"body2",color:"textSecondary",children:"ADR Module has low adoption. Consider promoting this feature to improve patient safety outcomes."})]})})]})]})]})]})]})]})},Ps=()=>{const[w,f]=x.useState(0),[t,L]=x.useState([]),[v,D]=x.useState([]),[C,B]=x.useState(null),[j,O]=x.useState([]),[I,W]=x.useState(!0),[i,m]=x.useState(0),[b,a]=x.useState(10),[u,Q]=x.useState(null),[h,P]=x.useState(!1),[te,c]=x.useState(!1),[T,E]=x.useState(null),[se,Se]=x.useState({role:"",status:"",licenseStatus:""}),[we,d]=x.useState(!1),[R,A]=x.useState(!1),[U,pe]=x.useState([]),[$,ge]=x.useState([]),[lt,He]=x.useState(""),[ot,We]=x.useState(!1),[Ce,ct]=x.useState(!1),[Ve,dt]=x.useState(""),[qe,xt]=x.useState(""),[ht,ut]=x.useState(""),_=le(r=>r.addNotification);x.useEffect(()=>{Ge()},[w,se]),x.useEffect(()=>{w===0&&jt()},[w]);const Ge=async()=>{W(!0);try{switch(w){case 0:await Ue();break;case 1:await Fe();break;case 2:await mt();break}}catch{_({type:"error",title:"Error",message:"Failed to load data",duration:5e3})}finally{W(!1)}},Ue=async()=>{try{const r=await zt({page:i+1,limit:b,...se});r.success&&L(r.data.users)}catch(r){console.error("Failed to load users:",r)}},Fe=async()=>{try{const r=await $t();r.success&&D(r.data.licenses)}catch(r){console.error("Failed to load licenses:",r)}},mt=async()=>{try{const r=await Ht();if(r.success){const k={users:r.data.userAnalytics.byRole.map(H=>({_id:H._id,count:H.count,active:H.count})),subscriptions:r.data.userAnalytics.byStatus.map(H=>({_id:H._id,count:H.count,active:H.count,revenue:0})),licenses:r.data.permissionAnalytics.byCategory.map(H=>({_id:H._id,count:H.count})),generated:new Date().toISOString()};B(k)}}catch(r){console.error("Failed to load analytics:",r)}},jt=async()=>{try{const r=await Vt({page:1,limit:100});r.success&&O(r.data.roles)}catch(r){console.error("Failed to load roles:",r)}},pt=async(r,k)=>{try{(await Gt(r,k)).success&&(_({type:"success",title:"Success",message:"User role updated successfully",duration:5e3}),Ue(),P(!1))}catch{_({type:"error",title:"Error",message:"Failed to update user role",duration:5e3})}},gt=async r=>{try{(await Jt(r,"Administrative action")).success&&(_({type:"success",title:"Success",message:"User suspended successfully",duration:5e3}),Ue())}catch{_({type:"error",title:"Error",message:"Failed to suspend user",duration:5e3})}},vt=async r=>{try{(await Qt(r)).success&&(_({type:"success",title:"Success",message:"License approved successfully",duration:5e3}),Fe())}catch{_({type:"error",title:"Error",message:"Failed to approve license",duration:5e3})}},yt=async(r,k)=>{try{(await Kt(r,k)).success&&(_({type:"success",title:"Success",message:"License rejected",duration:5e3}),Fe(),c(!1))}catch{_({type:"error",title:"Error",message:"Failed to reject license",duration:5e3})}},bt=async()=>{if(U.length===0||$.length===0){_({type:"error",title:"Error",message:"Please select at least one user and one role",duration:5e3});return}try{const r={userIds:U,roleIds:$,workspaceId:void 0,isTemporary:Ce,expiresAt:Ce?Ve:void 0,assignmentReason:qe},k=await Yt(r.userIds,r.roleIds[0]);k.success?(He(""),We(!0),d(!1),_({type:"success",title:"Bulk Operation Started",message:"Bulk role assignment has been initiated",duration:5e3})):_({type:"error",title:"Error",message:k.message||"Failed to start bulk role assignment",duration:5e3})}catch(r){console.error("Error in bulk role assignment:",r),_({type:"error",title:"Error",message:"Failed to start bulk role assignment",duration:5e3})}},ft=async()=>{if(U.length===0||$.length===0){_({type:"error",title:"Error",message:"Please select at least one user and one role",duration:5e3});return}try{const r=await Xt(U,$[0]);r.success?(He(""),We(!0),A(!1),_({type:"success",title:"Bulk Operation Started",message:"Bulk role revocation has been initiated",duration:5e3})):_({type:"error",title:"Error",message:r.message||"Failed to start bulk role revocation",duration:5e3})}catch(r){console.error("Error in bulk role revocation:",r),_({type:"error",title:"Error",message:"Failed to start bulk role revocation",duration:5e3})}},St=(r,k)=>{pe(k?[...U,r]:U.filter(H=>H!==r))},Je=(r,k)=>{ge(k?[...$,r]:$.filter(H=>H!==r))},wt=r=>{pe(r?t.map(k=>k._id):[])},Qe=r=>{ge(r?j.map(k=>k._id):[])},Ke=r=>{switch(r){case"active":return"success";case"pending":return"warning";case"suspended":return"error";case"approved":return"success";case"rejected":return"error";default:return"default"}},Ct=r=>{switch(r){case"super_admin":return"error";case"pharmacy_outlet":return"primary";case"pharmacy_team":return"secondary";case"pharmacist":return"info";case"intern_pharmacist":return"warning";default:return"default"}};return I&&!t.length&&!v.length&&!C?e.jsx(Pt,{message:"Loading admin dashboard..."}):e.jsxs(n,{p:3,children:[e.jsx(s,{variant:"h4",gutterBottom:!0,children:"Admin Dashboard"}),e.jsx(n,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:e.jsxs(rt,{value:w,onChange:(r,k)=>f(k),variant:"scrollable",scrollButtons:"auto",children:[e.jsx(V,{icon:e.jsx(De,{}),label:"User Management",iconPosition:"start"}),e.jsx(V,{icon:e.jsx(Lt,{badgeContent:v.length,color:"error",children:e.jsx(Bt,{})}),label:"License Verification",iconPosition:"start"}),e.jsx(V,{icon:e.jsx(Ae,{}),label:"Analytics",iconPosition:"start"}),e.jsx(V,{icon:e.jsx(Ee,{}),label:"Security",iconPosition:"start"}),e.jsx(V,{icon:e.jsx(ze,{}),label:"Usage Monitoring",iconPosition:"start"}),e.jsx(V,{icon:e.jsx(at,{}),label:"Migrations",iconPosition:"start"}),e.jsx(V,{icon:e.jsx(Re,{}),label:"Invitations",iconPosition:"start"}),e.jsx(V,{icon:e.jsx(ke,{}),label:"Locations",iconPosition:"start"}),e.jsx(V,{icon:e.jsx(ve,{}),label:"Webhooks",iconPosition:"start"}),e.jsx(V,{icon:e.jsx(Tt,{}),label:"System Settings",iconPosition:"start"})]})}),w===0&&e.jsxs(e.Fragment,{children:[e.jsxs(n,{sx:{mb:3,display:"flex",gap:2},children:[e.jsxs(y,{variant:"contained",startIcon:e.jsx(_t,{}),onClick:()=>d(!0),disabled:U.length===0,children:["Bulk Assign Roles (",U.length,")"]}),e.jsxs(y,{variant:"outlined",color:"error",startIcon:e.jsx(ss,{}),onClick:()=>A(!0),disabled:U.length===0,children:["Bulk Revoke Roles (",U.length,")"]})]}),e.jsxs(o,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(o,{size:{xs:12,md:3},children:e.jsxs(q,{fullWidth:!0,children:[e.jsx(G,{children:"Role"}),e.jsxs(J,{value:se.role,onChange:r=>Se({...se,role:r.target.value}),children:[e.jsx(S,{value:"",children:"All Roles"}),e.jsx(S,{value:"pharmacist",children:"Pharmacist"}),e.jsx(S,{value:"pharmacy_team",children:"Pharmacy Team"}),e.jsx(S,{value:"pharmacy_outlet",children:"Pharmacy Outlet"}),e.jsx(S,{value:"intern_pharmacist",children:"Intern Pharmacist"})]})]})}),e.jsx(o,{size:{xs:12,md:3},children:e.jsxs(q,{fullWidth:!0,children:[e.jsx(G,{children:"Status"}),e.jsxs(J,{value:se.status,onChange:r=>Se({...se,status:r.target.value}),children:[e.jsx(S,{value:"",children:"All Statuses"}),e.jsx(S,{value:"active",children:"Active"}),e.jsx(S,{value:"pending",children:"Pending"}),e.jsx(S,{value:"suspended",children:"Suspended"})]})]})})]}),e.jsxs(he,{component:re,children:[e.jsxs(ue,{children:[e.jsx(me,{children:e.jsxs(N,{children:[e.jsx(l,{padding:"checkbox",children:e.jsx(de,{checked:U.length===t.length&&t.length>0,indeterminate:U.length>0&&U.length<t.length,onChange:r=>wt(r.target.checked)})}),e.jsx(l,{children:"Name"}),e.jsx(l,{children:"Email"}),e.jsx(l,{children:"Role"}),e.jsx(l,{children:"Status"}),e.jsx(l,{children:"License Status"}),e.jsx(l,{children:"Subscription"}),e.jsx(l,{children:"Actions"})]})}),e.jsx(je,{children:t.map(r=>e.jsxs(N,{children:[e.jsx(l,{padding:"checkbox",children:e.jsx(de,{checked:U.includes(r._id),onChange:k=>St(r._id,k.target.checked)})}),e.jsxs(l,{children:[r.firstName," ",r.lastName]}),e.jsx(l,{children:r.email}),e.jsx(l,{children:e.jsx(z,{label:r.systemRole.replace("_"," "),color:Ct(r.systemRole),size:"small"})}),e.jsx(l,{children:e.jsx(z,{label:r.status,color:Ke(r.status),size:"small"})}),e.jsx(l,{children:e.jsx(z,{label:"not_required",color:Ke("not_required"),size:"small"})}),e.jsx(l,{children:e.jsx(z,{label:"free_trial",variant:"outlined",size:"small"})}),e.jsxs(l,{children:[e.jsx(xe,{title:"Edit User",children:e.jsx(M,{onClick:()=>{Q(r),P(!0)},children:e.jsx(Pe,{})})}),e.jsx(xe,{title:"Suspend User",children:e.jsx(M,{onClick:()=>gt(r._id),disabled:r.status==="suspended",children:e.jsx(Mt,{})})})]})]},r._id))})]}),e.jsx(Zt,{component:"div",count:-1,page:i,onPageChange:(r,k)=>m(k),rowsPerPage:b,onRowsPerPageChange:r=>a(parseInt(r.target.value))})]})]}),w===1&&e.jsx(he,{component:re,children:e.jsxs(ue,{children:[e.jsx(me,{children:e.jsxs(N,{children:[e.jsx(l,{children:"Name"}),e.jsx(l,{children:"Email"}),e.jsx(l,{children:"License Number"}),e.jsx(l,{children:"Document"}),e.jsx(l,{children:"Submitted"}),e.jsx(l,{children:"Actions"})]})}),e.jsx(je,{children:v.map(r=>e.jsxs(N,{children:[e.jsxs(l,{children:[r.firstName," ",r.lastName]}),e.jsx(l,{children:r.email}),e.jsx(l,{children:r.licenseNumber}),e.jsx(l,{children:e.jsx(y,{startIcon:e.jsx(Nt,{}),size:"small",onClick:()=>{window.open(`/api/license/document/${r._id}`,"_blank")},children:r.licenseDocument.fileName})}),e.jsx(l,{children:new Date(r.createdAt).toLocaleDateString()}),e.jsxs(l,{children:[e.jsx(xe,{title:"Approve License",children:e.jsx(M,{onClick:()=>vt(r._id),color:"success",children:e.jsx(_e,{})})}),e.jsx(xe,{title:"Reject License",children:e.jsx(M,{onClick:()=>{E(r),c(!0)},color:"error",children:e.jsx(Et,{})})})]})]},r._id))})]})}),w===2&&C&&e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{size:{xs:12,md:4},children:e.jsx(p,{children:e.jsxs(g,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"User Statistics"}),C.users.map(r=>e.jsxs(n,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(s,{variant:"body2",children:[r._id,":"]}),e.jsxs(s,{variant:"body2",children:[r.active,"/",r.count]})]},r._id))]})})}),e.jsx(o,{size:{xs:12,md:4},children:e.jsx(p,{children:e.jsxs(g,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Subscription Statistics"}),C.subscriptions.map(r=>{var k;return e.jsxs(n,{sx:{mb:1},children:[e.jsxs(n,{display:"flex",justifyContent:"space-between",children:[e.jsxs(s,{variant:"body2",children:[r._id,":"]}),e.jsx(s,{variant:"body2",children:r.count})]}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:["Revenue: ₦",(k=r.revenue)==null?void 0:k.toLocaleString()]})]},r._id)})]})})}),e.jsx(o,{size:{xs:12,md:4},children:e.jsx(p,{children:e.jsxs(g,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"License Statistics"}),C.licenses.map(r=>e.jsxs(n,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(s,{variant:"body2",children:[r._id,":"]}),e.jsx(s,{variant:"body2",children:r.count})]},r._id))]})})})]}),w===3&&e.jsx(rs,{}),w===4&&e.jsx(ns,{}),w===5&&e.jsx(is,{}),w===6&&e.jsx(as,{}),w===7&&e.jsx(ls,{}),w===8&&e.jsx(os,{}),w===9&&e.jsx(cs,{}),w===10&&e.jsx(Te,{severity:"info",children:"System settings panel will be available in the next update."}),e.jsxs(K,{open:h,onClose:()=>P(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Y,{children:"Edit User Role"}),e.jsx(X,{children:u&&e.jsxs(n,{pt:1,children:[e.jsxs(s,{variant:"body1",gutterBottom:!0,children:["User: ",u.firstName," ",u.lastName]}),e.jsxs(q,{fullWidth:!0,children:[e.jsx(G,{children:"Role"}),e.jsxs(J,{value:u.systemRole,onChange:r=>Q({...u,systemRole:r.target.value}),children:[e.jsx(S,{value:"pharmacist",children:"Pharmacist"}),e.jsx(S,{value:"pharmacy_team",children:"Pharmacy Team"}),e.jsx(S,{value:"pharmacy_outlet",children:"Pharmacy Outlet"}),e.jsx(S,{value:"intern_pharmacist",children:"Intern Pharmacist"})]})]})]})}),e.jsxs(Z,{children:[e.jsx(y,{onClick:()=>P(!1),children:"Cancel"}),e.jsx(y,{onClick:()=>u&&pt(u._id,u.systemRole),variant:"contained",children:"Update Role"})]})]}),e.jsxs(K,{open:te,onClose:()=>c(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Y,{children:"Reject License"}),e.jsx(X,{children:e.jsx(F,{fullWidth:!0,multiline:!0,rows:4,label:"Rejection Reason",placeholder:"Please provide a reason for rejecting this license...",margin:"normal",id:"rejection-reason"})}),e.jsxs(Z,{children:[e.jsx(y,{onClick:()=>c(!1),children:"Cancel"}),e.jsx(y,{onClick:()=>{var k;const r=(k=document.getElementById("rejection-reason"))==null?void 0:k.value;T&&r&&yt(T._id,r)},variant:"contained",color:"error",children:"Reject License"})]})]}),e.jsxs(K,{open:we,onClose:()=>d(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(Y,{children:"Bulk Assign Roles"}),e.jsx(X,{children:e.jsxs(n,{sx:{mt:2},children:[e.jsxs(s,{variant:"subtitle1",gutterBottom:!0,children:["Selected Users (",U.length,")"]}),e.jsx(n,{sx:{mb:3,maxHeight:150,overflow:"auto"},children:t.filter(r=>U.includes(r._id)).map(r=>e.jsx(z,{label:`${r.firstName} ${r.lastName}`,sx:{m:.5}},r._id))}),e.jsx(s,{variant:"subtitle1",gutterBottom:!0,children:"Select Roles"}),e.jsxs(n,{sx:{mb:3},children:[e.jsx(ne,{control:e.jsx(de,{checked:$.length===j.length&&j.length>0,indeterminate:$.length>0&&$.length<j.length,onChange:r=>Qe(r.target.checked)}),label:"Select All Roles"}),e.jsx(n,{sx:{maxHeight:200,overflow:"auto"},children:j.map(r=>e.jsx(ne,{control:e.jsx(de,{checked:$.includes(r._id),onChange:k=>Je(r._id,k.target.checked)}),label:r.displayName},r._id))})]}),e.jsxs(Wt,{children:[e.jsx(Ut,{expandIcon:e.jsx(Ft,{}),children:e.jsx(s,{children:"Advanced Options"})}),e.jsx(Ot,{children:e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(ne,{control:e.jsx(Be,{checked:Ce,onChange:r=>ct(r.target.checked)}),label:"Temporary Assignment"}),Ce&&e.jsx(F,{fullWidth:!0,label:"Expiration Date",type:"datetime-local",value:Ve,onChange:r=>dt(r.target.value),InputLabelProps:{shrink:!0}}),e.jsx(F,{fullWidth:!0,label:"Assignment Reason (Optional)",value:qe,onChange:r=>xt(r.target.value),multiline:!0,rows:2})]})})]})]})}),e.jsxs(Z,{children:[e.jsx(y,{onClick:()=>d(!1),children:"Cancel"}),e.jsx(y,{onClick:bt,variant:"contained",disabled:$.length===0,children:"Assign Roles"})]})]}),e.jsxs(K,{open:R,onClose:()=>A(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(Y,{children:"Bulk Revoke Roles"}),e.jsx(X,{children:e.jsxs(n,{sx:{mt:2},children:[e.jsxs(s,{variant:"subtitle1",gutterBottom:!0,children:["Selected Users (",U.length,")"]}),e.jsx(n,{sx:{mb:3,maxHeight:150,overflow:"auto"},children:t.filter(r=>U.includes(r._id)).map(r=>e.jsx(z,{label:`${r.firstName} ${r.lastName}`,sx:{m:.5}},r._id))}),e.jsx(s,{variant:"subtitle1",gutterBottom:!0,children:"Select Roles to Revoke"}),e.jsxs(n,{sx:{mb:3},children:[e.jsx(ne,{control:e.jsx(de,{checked:$.length===j.length&&j.length>0,indeterminate:$.length>0&&$.length<j.length,onChange:r=>Qe(r.target.checked)}),label:"Select All Roles"}),e.jsx(n,{sx:{maxHeight:200,overflow:"auto"},children:j.map(r=>e.jsx(ne,{control:e.jsx(de,{checked:$.includes(r._id),onChange:k=>Je(r._id,k.target.checked)}),label:r.displayName},r._id))})]}),e.jsx(F,{fullWidth:!0,label:"Revocation Reason (Optional)",value:ht,onChange:r=>ut(r.target.value),multiline:!0,rows:2})]})}),e.jsxs(Z,{children:[e.jsx(y,{onClick:()=>A(!1),children:"Cancel"}),e.jsx(y,{onClick:ft,variant:"contained",color:"error",disabled:$.length===0,children:"Revoke Roles"})]})]}),e.jsx(qt,{open:ot,onClose:()=>{We(!1),pe([]),ge([]),Ge()},operationId:lt,initialData:{type:"role_assignment",status:"pending",progress:{total:U.length,processed:0,successful:0,failed:0},startTime:new Date().toISOString(),errors:[],warnings:[],metadata:{userCount:U.length}}})]})};export{Ps as default};
