import{c9 as c}from"./index-B_pWc9hu.js";const n=c.create({baseURL:"http://localhost:5000/api",timeout:1e4,headers:{"Content-Type":"application/json"},withCredentials:!0});n.interceptors.request.use(e=>e,e=>Promise.reject(e));let t=!1,i=[];const l=e=>{i.push(e)},h=e=>{i.forEach(r=>r(e)),i=[]};n.interceptors.response.use(e=>e,async e=>{var o,a,u;const r=e.config;if(((o=e.response)==null?void 0:o.status)===401&&!r._retry&&!((a=r.url)!=null&&a.includes("/auth/login"))&&!((u=r.url)!=null&&u.includes("/auth/refresh-token"))){if(t)return new Promise(s=>{l(()=>{s(n(r))})});t=!0,r._retry=!0;try{return(await c.post("http://localhost:5000/api/auth/refresh-token",{},{withCredentials:!0})).status===200?(h("refreshed"),t=!1,n(r)):(window.location.href="/login?session=expired",Promise.reject(e))}catch(s){return t=!1,window.location.href="/login?session=expired",Promise.reject(s)}}return Promise.reject(e)});export{n as a};
