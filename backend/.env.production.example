# AI Diagnostics & Therapeutics Module - Production Environment Configuration

# Server Configuration
NODE_ENV=production
PORT=5000
INSTANCE_ID=0

# Database Configuration
MONGODB_URI=mongodb://username:password@mongodb-cluster:27017/PharmacyCopilot-prod?authSource=admin&replicaSet=rs0&ssl=true
MONGODB_MAX_POOL_SIZE=50
MONGODB_MIN_POOL_SIZE=5
MONGODB_MAX_IDLE_TIME_MS=30000
MONGODB_SERVER_SELECTION_TIMEOUT_MS=5000

# Redis Configuration (for caching and sessions)
# Option 1: Upstash Redis (recommended for serverless/Render)
# Get from: https://console.upstash.com
REDIS_URL=redis://default:YOUR_PASSWORD@YOUR_HOST.upstash.io:6379

# Option 2: Render Redis
# REDIS_URL=redis://red-xxxxx:6379

# Option 3: Other Redis providers (Heroku, Railway, etc.)
# REDIS_URL=redis://your-redis-host:6379

# Option 4: Use individual Redis connection parameters (legacy)
# REDIS_HOST=redis-cluster.cache.amazonaws.com
# REDIS_PORT=6379
# REDIS_PASSWORD=your-redis-password
# REDIS_TLS=true
# REDIS_DB=0
# REDIS_MAX_RETRIES=3

# Frontend Configuration
FRONTEND_URL=https://app.PharmacyCopilot.com
CORS_ORIGINS=https://app.PharmacyCopilot.com,https://admin.PharmacyCopilot.com

# JWT Configuration
JWT_SECRET=your-super-secure-jwt-secret-256-bits-minimum
JWT_EXPIRE=15m
JWT_REFRESH_SECRET=your-super-secure-refresh-secret-256-bits-minimum
JWT_REFRESH_EXPIRE=30d
JWT_ISSUER=PharmacyCopilot-api
JWT_AUDIENCE=PharmacyCopilot-app

# Session Configuration
SESSION_SECRET=your-super-secure-session-secret-256-bits-minimum
SESSION_MAX_AGE=86400000
SESSION_SECURE=true
SESSION_SAME_SITE=strict

# AI Services Configuration
OPENROUTER_API_KEY=your-openrouter-api-key
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
OPENROUTER_MODEL=deepseek/deepseek-v3.1
OPENROUTER_MAX_TOKENS=4000
OPENROUTER_TEMPERATURE=0.1
OPENROUTER_TIMEOUT=30000
OPENROUTER_RETRY_ATTEMPTS=3
OPENROUTER_RETRY_DELAY=2000

# Clinical APIs Configuration
RXNORM_API_BASE_URL=https://rxnav.nlm.nih.gov/REST
RXNORM_API_TIMEOUT=10000
RXNORM_API_RETRY_ATTEMPTS=3

OPENFDA_API_BASE_URL=https://api.fda.gov
OPENFDA_API_KEY=your-openfda-api-key
OPENFDA_API_TIMEOUT=10000
OPENFDA_API_RETRY_ATTEMPTS=3

LOINC_API_BASE_URL=https://loinc.org/api
LOINC_API_KEY=your-loinc-api-key
LOINC_API_TIMEOUT=10000

# FHIR Configuration (optional)
FHIR_SERVER_URL=https://your-fhir-server.com/fhir/R4
FHIR_CLIENT_ID=your-fhir-client-id
FHIR_CLIENT_SECRET=your-fhir-client-secret
FHIR_SCOPE=system/*.read system/*.write
FHIR_TIMEOUT=15000

# Email Configuration
SMTP_HOST=smtp.resend.com
SMTP_PORT=587
SMTP_SECURE=true
SMTP_USER=resend
SMTP_PASS=your-resend-api-key
EMAIL_FROM=noreply@PharmacyCopilot.com
EMAIL_FROM_NAME=PharmacyCopilot AI Diagnostics

# File Upload Configuration
MAX_FILE_SIZE=10485760
UPLOAD_PATH=/var/uploads/PharmacyCopilot
CLOUDINARY_CLOUD_NAME=your-cloudinary-cloud
CLOUDINARY_API_KEY=your-cloudinary-key
CLOUDINARY_API_SECRET=your-cloudinary-secret
CLOUDINARY_FOLDER=PharmacyCopilot-prod

# Security Configuration
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_AI_WINDOW_MS=900000
RATE_LIMIT_AI_MAX_REQUESTS=10
BCRYPT_ROUNDS=12
HELMET_CSP_ENABLED=true
CORS_CREDENTIALS=true

# Monitoring and Logging
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE_PATH=/var/log/PharmacyCopilot/app.log
LOG_ERROR_FILE_PATH=/var/log/PharmacyCopilot/error.log
LOG_MAX_SIZE=100m
LOG_MAX_FILES=30
LOG_COMPRESS=true

# Performance Monitoring
ENABLE_PERFORMANCE_MONITORING=true
PERFORMANCE_SAMPLE_RATE=0.1
METRICS_PORT=9090
HEALTH_CHECK_TIMEOUT=5000

# Error Tracking
SENTRY_DSN=your-sentry-dsn
SENTRY_ENVIRONMENT=production
SENTRY_SAMPLE_RATE=0.1
SENTRY_TRACES_SAMPLE_RATE=0.01

# Feature Flags
FEATURE_FLAGS_CACHE_TTL=300
FEATURE_FLAGS_REFRESH_INTERVAL=60000
AI_DIAGNOSTICS_ENABLED=true
AI_DIAGNOSTICS_ROLLOUT_PERCENTAGE=100
LAB_INTEGRATION_ENABLED=true
FHIR_INTEGRATION_ENABLED=false
ADVANCED_ANALYTICS_ENABLED=true

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=PharmacyCopilot-backups-prod
BACKUP_S3_REGION=us-east-1
BACKUP_ENCRYPTION_KEY=your-backup-encryption-key

# SSL/TLS Configuration
SSL_CERT_PATH=/etc/ssl/certs/PharmacyCopilot.crt
SSL_KEY_PATH=/etc/ssl/private/PharmacyCopilot.key
SSL_CA_PATH=/etc/ssl/certs/ca-bundle.crt
FORCE_HTTPS=true

# Database Encryption
DB_ENCRYPTION_KEY=your-database-encryption-key-256-bits
ENCRYPT_SENSITIVE_FIELDS=true

# Audit Logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_LEVEL=info
AUDIT_LOG_FILE=/var/log/PharmacyCopilot/audit.log
AUDIT_LOG_RETENTION_DAYS=2555  # 7 years for healthcare compliance

# Compliance and Regulatory
HIPAA_COMPLIANCE_MODE=true
GDPR_COMPLIANCE_MODE=true
DATA_RETENTION_POLICY_DAYS=2555
CONSENT_TRACKING_ENABLED=true

# Cache Configuration
CACHE_TTL_DEFAULT=300
CACHE_TTL_DRUG_INFO=3600
CACHE_TTL_LAB_RESULTS=1800
CACHE_TTL_AI_RESULTS=86400
CACHE_MAX_SIZE=1000

# Worker Configuration
WORKER_CONCURRENCY=4
WORKER_MAX_JOBS=100
WORKER_RETRY_ATTEMPTS=3
WORKER_RETRY_DELAY=5000

# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30000
HEALTH_CHECK_TIMEOUT=5000
HEALTH_CHECK_ENDPOINTS=/api/health,/api/health/database,/api/health/redis,/api/health/ai-services

# Load Balancer Configuration
TRUST_PROXY=true
PROXY_TIMEOUT=30000
KEEP_ALIVE_TIMEOUT=65000

# Graceful Shutdown
GRACEFUL_SHUTDOWN_TIMEOUT=30000
SHUTDOWN_SIGNALS=SIGTERM,SIGINT

# Development/Debug (should be false in production)
DEBUG_MODE=false
VERBOSE_LOGGING=false
ENABLE_SWAGGER=false
ENABLE_PLAYGROUND=false